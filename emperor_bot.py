
import telebot
import time
import ephem
from datetime import datetime, timedelta

BOT_TOKEN = "7166686748:AAFnyfjq5UsunijP_p8HQiYeKHh3qoAM5RA"
bot = telebot.TeleBot(BOT_TOKEN)

def get_russian_zodiac(eng_sign):
    zodiac_map = {
        'Aries': '–û–≤–µ–Ω', 'Taurus': '–¢–µ–ª–µ—Ü', 'Gemini': '–ë–ª–∏–∑–Ω–µ—Ü—ã',
        'Cancer': '–†–∞–∫', 'Leo': '–õ–µ–≤', 'Virgo': '–î–µ–≤–∞',
        'Libra': '–í–µ—Å—ã', 'Scorpio': '–°–∫–æ—Ä–ø–∏–æ–Ω', 'Sagittarius': '–°—Ç—Ä–µ–ª–µ—Ü',
        'Capricorn': '–ö–æ–∑–µ—Ä–æ–≥', 'Aquarius': '–í–æ–¥–æ–ª–µ–π', 'Pisces': '–†—ã–±—ã'
    }
    return zodiac_map.get(eng_sign, eng_sign)

def get_planet_ruler(sign):
    rulers = {
        'Aries': '–ú–∞—Ä—Å', 'Taurus': '–í–µ–Ω–µ—Ä–∞', 'Gemini': '–ú–µ—Ä–∫—É—Ä–∏–π',
        'Cancer': '–õ—É–Ω–∞', 'Leo': '–°–æ–ª–Ω—Ü–µ', 'Virgo': '–ú–µ—Ä–∫—É—Ä–∏–π',
        'Libra': '–í–µ–Ω–µ—Ä–∞', 'Scorpio': '–ü–ª—É—Ç–æ–Ω', 'Sagittarius': '–Æ–ø–∏—Ç–µ—Ä',
        'Capricorn': '–°–∞—Ç—É—Ä–Ω', 'Aquarius': '–£—Ä–∞–Ω', 'Pisces': '–ù–µ–ø—Ç—É–Ω'
    }
    return rulers.get(sign, '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')

def generate_strategic_analysis(question, moon_sign, sun_sign, mars_sign, venus_sign, merc_sign, jup_sign):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å –ø–ª–∞–Ω–æ–º –¥–µ–π—Å—Ç–≤–∏–π"""
    
    current_date = datetime.now()
    tomorrow = current_date + timedelta(days=1)
    day3 = current_date + timedelta(days=2)
    
    analysis = f"""
üîÆ –•–û–†–ê–†–ù–ê–Ø –ö–ê–†–¢–ê –ù–ê {current_date.strftime('%H:%M, %d.%m.%Y')}, –ú–û–°–ö–í–ê

–í–æ—Å—Ö–æ–¥: {sun_sign}. –õ—É–Ω–∞: {moon_sign}.

---

–ê–ù–ê–õ–ò–ó: {question}

¬∑ –í—ã (–ö–≤–µ—Ä–µ–Ω—Ç): 1-–π –¥–æ–º –≤ {sun_sign}. –£–ø—Ä–∞–≤–∏—Ç–µ–ª—å ‚Äî {get_planet_ruler(sun_sign)}.
¬∑ –ü–∞—Ä—Ç–Ω–µ—Ä/–°–∏—Ç—É–∞—Ü–∏—è (–ö–≤–µ—Å–∏—Ç): 7-–π –¥–æ–º –≤ {get_opposite_sign(sun_sign)}. –£–ø—Ä–∞–≤–∏—Ç–µ–ª—å ‚Äî {get_planet_ruler(get_opposite_sign(sun_sign))}.
¬∑ –ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞ –¥–µ–π—Å—Ç–≤–∏—è: 1-–π –¥–æ–º –æ—Ç 7-–≥–æ = 7-–π –¥–æ–º. –°–º–æ—Ç—Ä–∏–º –ú–∞—Ä—Å (–∏–º–ø—É–ª—å—Å –∫ –¥–µ–π—Å—Ç–≤–∏—é).

–ö–õ–Æ–ß–ï–í–´–ï –ê–°–ü–ï–ö–¢–´ –ò –°–¢–†–ê–¢–ï–ì–ò–Ø:

1. –ú–µ—Ä–∫—É—Ä–∏–π (–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è) –≤ {merc_sign}.
   ¬∑ –í–∞—à–∞ —Å–∏–ª–∞ ‚Äî –≤ {get_mercury_strength(merc_sign)}. –ü—Ä—è–º—ã–µ –ø—Ä–æ—Å—å–±—ã –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—é—Ç.

2. –Æ–ø–∏—Ç–µ—Ä (–ú–æ—Ç–∏–≤–∞—Ü–∏—è) –≤ {jup_sign}.
   ¬∑ –ö–ª—é—á–µ–≤–∞—è –º–æ—Ç–∏–≤–∞—Ü–∏—è ‚Äî {get_jupiter_motivation(jup_sign)}. –ù—É–∂–Ω–æ –Ω–µ –ø—Ä–æ—Å–∏—Ç—å, –∞ –∑–∞–∏–Ω—Ç—Ä–∏–≥–æ–≤–∞—Ç—å.

3. –ú–∞—Ä—Å (–ò–º–ø—É–ª—å—Å) –≤ {mars_sign}.
   ¬∑ –ß—Ç–æ–±—ã –ú–∞—Ä—Å —Å—Ä–∞–±–æ—Ç–∞–ª, –Ω—É–∂–µ–Ω {get_mars_trigger(mars_sign)}.

4. –õ—É–Ω–∞ (–≠–º–æ—Ü–∏–∏) –≤ {moon_sign}.
   ¬∑ {get_moon_opportunity(moon_sign)}

---

–ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô –ù–ê 3 –î–ù–Ø (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)

–î–µ–Ω—å 1 ({current_date.strftime('%d.%m')}):

¬∑ –î–µ–π—Å—Ç–≤–∏–µ: {get_day1_action(moon_sign)}
¬∑ –°–º—ã—Å–ª: {get_day1_strategy(moon_sign)}

–î–µ–Ω—å 2 ({tomorrow.strftime('%d.%m')}):

¬∑ –î–µ–π—Å—Ç–≤–∏–µ: {get_day2_action(merc_sign)}
¬∑ –°–º—ã—Å–ª: {get_day2_strategy(merc_sign)}

–î–µ–Ω—å 3 ({day3.strftime('%d.%m')}):

¬∑ –î–µ–π—Å—Ç–≤–∏–µ: {get_day3_action(mars_sign)}
¬∑ –°–º—ã—Å–ª: {get_day3_strategy(mars_sign)}

---

–ß–ï–ì–û –ù–ï –î–ï–õ–ê–¢–¨:

{get_avoid_actions(sun_sign)}

–í–∞—à–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è ‚Äî {get_overall_strategy(moon_sign, mars_sign)} –ò–º–µ–Ω–Ω–æ —ç—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –µ–≥–æ –ú–∞—Ä—Å –∏ –Æ–ø–∏—Ç–µ—Ä.
"""
    return analysis

def get_opposite_sign(sign):
    opposites = {
        '–û–≤–µ–Ω': '–í–µ—Å—ã', '–¢–µ–ª–µ—Ü': '–°–∫–æ—Ä–ø–∏–æ–Ω', '–ë–ª–∏–∑–Ω–µ—Ü—ã': '–°—Ç—Ä–µ–ª–µ—Ü',
        '–†–∞–∫': '–ö–æ–∑–µ—Ä–æ–≥', '–õ–µ–≤': '–í–æ–¥–æ–ª–µ–π', '–î–µ–≤–∞': '–†—ã–±—ã',
        '–í–µ—Å—ã': '–û–≤–µ–Ω', '–°–∫–æ—Ä–ø–∏–æ–Ω': '–¢–µ–ª–µ—Ü', '–°—Ç—Ä–µ–ª–µ—Ü': '–ë–ª–∏–∑–Ω–µ—Ü—ã',
        '–ö–æ–∑–µ—Ä–æ–≥': '–†–∞–∫', '–í–æ–¥–æ–ª–µ–π': '–õ–µ–≤', '–†—ã–±—ã': '–î–µ–≤–∞'
    }
    return opposites.get(sign, sign)

def get_mercury_strength(sign):
    strengths = {
        '–û–≤–µ–Ω': '–ø—Ä—è–º–æ—Ç–µ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏', '–¢–µ–ª–µ—Ü': '–ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç–∏', 
        '–ë–ª–∏–∑–Ω–µ—Ü—ã': '–∫–æ–º–º—É–Ω–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏', '–†–∞–∫': '—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –≥–ª—É–±–∏–Ω–µ',
        '–õ–µ–≤': '—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏', '–î–µ–≤–∞': '–∞–Ω–∞–ª–∏—Ç–∏—á–Ω–æ—Å—Ç–∏',
        '–í–µ—Å—ã': '–¥–∏–ø–ª–æ–º–∞—Ç–∏–∏', '–°–∫–æ—Ä–ø–∏–æ–Ω': '–∑–∞–≥–∞–¥–æ—á–Ω–æ—Å—Ç–∏ –∏ –≥–ª—É–±–∏–Ω–µ',
        '–°—Ç—Ä–µ–ª–µ—Ü': '–æ–ø—Ç–∏–º–∏–∑–º–µ', '–ö–æ–∑–µ—Ä–æ–≥': '—Å—Ç—Ä–∞—Ç–µ–≥–∏—á–Ω–æ—Å—Ç–∏',
        '–í–æ–¥–æ–ª–µ–π': '–Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Å—Ç–∏', '–†—ã–±—ã': '–∏–Ω—Ç—É–∏—Ü–∏–∏'
    }
    return strengths.get(sign, '—É–Ω–∏–∫–∞–ª—å–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ')

def get_jupiter_motivation(sign):
    motivations = {
        '–û–≤–µ–Ω': '–≤—ã–∑–æ–≤ –∏ –¥–µ–π—Å—Ç–≤–∏–µ', '–¢–µ–ª–µ—Ü': '—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –∫–æ–º—Ñ–æ—Ä—Ç',
        '–ë–ª–∏–∑–Ω–µ—Ü—ã': '–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –ª—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ –∏ –∏–≥—Ä–∞', 
        '–†–∞–∫': '—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', '–õ–µ–≤': '–ø—Ä–∏–∑–Ω–∞–Ω–∏–µ –∏ –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ',
        '–î–µ–≤–∞': '–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–ª—å–∑–∞', '–í–µ—Å—ã': '–≥–∞—Ä–º–æ–Ω–∏—è –∏ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ',
        '–°–∫–æ—Ä–ø–∏–æ–Ω': '–≥–ª—É–±–∏–Ω–∞ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è', '–°—Ç—Ä–µ–ª–µ—Ü': '—Å–≤–æ–±–æ–¥–∞ –∏ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è',
        '–ö–æ–∑–µ—Ä–æ–≥': '–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç—É—Å', '–í–æ–¥–æ–ª–µ–π': '–∏–Ω–Ω–æ–≤–∞—Ü–∏–∏ –∏ —Å–≤–æ–±–æ–¥–∞',
        '–†—ã–±—ã': '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ'
    }
    return motivations.get(sign, '–ª–∏—á–Ω—ã–π –∏–Ω—Ç–µ—Ä–µ—Å')

def get_mars_trigger(sign):
    triggers = {
        '–û–≤–µ–Ω': '–≤—ã–∑–æ–≤, –Ω–∞–º—ë–∫ –Ω–∞ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ', '–¢–µ–ª–µ—Ü': '–æ–±–µ—â–∞–Ω–∏–µ –∫–æ–º—Ñ–æ—Ä—Ç–∞',
        '–ë–ª–∏–∑–Ω–µ—Ü—ã': '–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –∑–∞–≥–∞–¥–∫–∞', '–†–∞–∫': '—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫',
        '–õ–µ–≤': '–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—è–≤–∏—Ç—å —Å–µ–±—è', '–î–µ–≤–∞': '–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞',
        '–í–µ—Å—ã': '—ç—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–º—É–ª', '–°–∫–æ—Ä–ø–∏–æ–Ω': '–≥–ª—É–±–∏–Ω–Ω–∞—è —Å—Ç—Ä–∞—Å—Ç—å',
        '–°—Ç—Ä–µ–ª–µ—Ü': '–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ', '–ö–æ–∑–µ—Ä–æ–≥': '–∞–º–±–∏—Ü–∏–æ–∑–Ω–∞—è —Ü–µ–ª—å',
        '–í–æ–¥–æ–ª–µ–π': '–Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥', '–†—ã–±—ã': '—Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –∏–º–ø—É–ª—å—Å'
    }
    return triggers.get(sign, '–ª–∏—á–Ω–∞—è –º–æ—Ç–∏–≤–∞—Ü–∏—è')

def get_moon_opportunity(sign):
    opportunities = {
        '–†–∞–∫': '–õ—É–Ω–∞ –∏–¥—ë—Ç –∫ –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–º—É –∞—Å–ø–µ–∫—Ç—É —Å –í–µ–Ω–µ—Ä–æ–π - –æ–∫–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ 16-24 —á–∞—Å–∞',
        '–¢–µ–ª–µ—Ü': '–°—Ç–∞–±–∏–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –õ—É–Ω—ã —Å–æ–∑–¥–∞—ë—Ç –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —Å–±–ª–∏–∂–µ–Ω–∏—è',
        '–í–µ—Å—ã': '–õ—É–Ω–∞ –≤ –±–∞–ª–∞–Ω—Å–µ - –∏–¥–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –¥–∏–ø–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤',
        '–°–∫–æ—Ä–ø–∏–æ–Ω': '–ì–ª—É–±–æ–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è –õ—É–Ω—ã —Ç—Ä–µ–±—É–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Ä–ø–µ–Ω–∏—è - –∫–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç —á–µ—Ä–µ–∑ 2-3 –¥–Ω—è'
    }
    return opportunities.get(sign, '–¢–µ–∫—É—â–∏–µ –∞—Å–ø–µ–∫—Ç—ã –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç—Å—Ç–≤—É—é—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–º—É –ø–æ–¥—Ö–æ–¥—É')

def get_day1_action(sign):
    actions = {
        '–†–∞–∫': '–°–æ–∑–¥–∞—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –Ω–∞–º—ë–∫ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö - —Ñ–æ—Ç–æ —Å –≥–ª—É–±–æ–∫–∏–º, –Ω–æ –Ω–µ —è–≤–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º',
        '–°–∫–æ—Ä–ø–∏–æ–Ω': '–í—ã–ª–æ–∂–∏—Ç—å –∑–∞–≥–∞–¥–æ—á–Ω—ã–π —Å—Ç–∞—Ç—É—Å —Å –Ω–∞–º—ë–∫–æ–º –Ω–∞ –æ–±—â—É—é —Ç–∞–π–Ω—É',
        '–ë–ª–∏–∑–Ω–µ—Ü—ã': '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∏–º—É–ª - –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é —Å—Ç–∞—Ç—å—é –∏–ª–∏ –≤–æ–ø—Ä–æ—Å',
        '–õ–µ–≤': '–ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ —Å—Ç–æ—Ä–∏—Å —Å –Ω–∞–º—ë–∫–æ–º –Ω–∞ –≤—ã–∑–æ–≤'
    }
    return actions.get(sign, '–°–æ–∑–¥–∞—Ç—å –ª—ë–≥–∫–∏–π –Ω–∞–º—ë–∫ –Ω–∞ –≤–∞—à–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ —Å–æ—Ü—Å–µ—Ç–∏')

def get_day1_strategy(sign):
    strategies = {
        '–†–∞–∫': '–í—ã–∑—ã–≤–∞–µ—Ç–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫ —á–µ—Ä–µ–∑ –Ω–æ—Å—Ç–∞–ª—å–≥–∏—é –∏–ª–∏ –æ–±—â–∏–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è',
        '–°–∫–æ—Ä–ø–∏–æ–Ω': '–°–æ–∑–¥–∞—ë—Ç–µ –∏–Ω—Ç—Ä–∏–≥—É —á–µ—Ä–µ–∑ –Ω–µ–¥–æ—Å–∫–∞–∑–∞–Ω–Ω–æ—Å—Ç—å',
        '–ë–ª–∏–∑–Ω–µ—Ü—ã': '–°—Ç–∏–º—É–ª–∏—Ä—É–µ—Ç–µ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –ª—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ',
        '–õ–µ–≤': '–ë—Ä–æ—Å–∞–µ—Ç–µ –≤—ã–∑–æ–≤ —á–µ—Ä–µ–∑ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é —Å–≤–æ–µ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏'
    }
    return strategies.get(sign, '–°–æ–∑–¥–∞—ë—Ç–µ –ª—ë–≥–∫—É—é –∏–Ω—Ç—Ä–∏–≥—É –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è')

def get_day2_action(sign):
    actions = {
        '–ë–ª–∏–∑–Ω–µ—Ü—ã': '–ö–∏–Ω—É—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–µ–º—É –µ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –±–µ–∑ –ª–∏—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞',
        '–°–∫–æ—Ä–ø–∏–æ–Ω': '–°–¥–µ–ª–∞—Ç—å –Ω–∞–º—ë–∫ –Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≤—á–µ—Ä–∞—à–Ω–µ–π —Ç–µ–º—ã',
        '–†–∞–∫': '–°–æ–∑–¥–∞—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ –æ–±—â–µ–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ',
        '–û–≤–µ–Ω': '–ë—Ä–æ—Å–∏—Ç—å –ª—ë–≥–∫–∏–π –≤—ã–∑–æ–≤ —á–µ—Ä–µ–∑ –≤–æ–ø—Ä–æ—Å'
    }
    return actions.get(sign, '–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–≤–æ–¥ –¥–ª—è –Ω–∞—á–∞–ª–∞ –¥–∏–∞–ª–æ–≥–∞')

def get_day2_strategy(sign):
    strategies = {
        '–ë–ª–∏–∑–Ω–µ—Ü—ã': '–î–∞—ë—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø—Ä–µ–¥–ª–æ–≥ –¥–ª—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ –Ω–∞ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—É—é —Ç–µ–º—É',
        '–°–∫–æ—Ä–ø–∏–æ–Ω': '–£–≥–ª—É–±–ª—è–µ—Ç–µ –≤—á–µ—Ä–∞—à–Ω—é—é –∏–Ω—Ç—Ä–∏–≥—É',
        '–†–∞–∫': '–£—Å–∏–ª–∏–≤–∞–µ—Ç–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Å–≤—è–∑—å',
        '–û–≤–µ–Ω': '–°—Ç–∏–º—É–ª–∏—Ä—É–µ—Ç–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç–∏–Ω–∫—Ç'
    }
    return strategies.get(sign, '–°–æ–∑–¥–∞—ë—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –ª—ë–≥–∫–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞')

def get_day3_action(sign):
    actions = {
        '–û–≤–µ–Ω': '–ü—Ä—è–º–æ–π –Ω–æ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤',
        '–†–∞–∫': '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤–∏–¥–µ–æ',
        '–°–∫–æ—Ä–ø–∏–æ–Ω': '–ì–ª—É–±–æ–∫–∏–π –Ω–∞–º—ë–∫ –Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ',
        '–õ–µ–≤': '–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Å–≤–æ–µ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏'
    }
    return actions.get(sign, '–¢–≤–æ—Ä—á–µ—Å–∫–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Å–µ–±–µ')

def get_day3_strategy(sign):
    strategies = {
        '–û–≤–µ–Ω': '–ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç–µ –∏–º–ø—É–ª—å—Å –∫ –¥–µ–π—Å—Ç–≤–∏—é —á–µ—Ä–µ–∑ –≤—ã–∑–æ–≤',
        '–†–∞–∫': '–í—ã–∑—ã–≤–∞–µ—Ç–µ –≥–ª—É–±–∏–Ω–Ω—ã–π —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫',
        '–°–∫–æ—Ä–ø–∏–æ–Ω': '–ó–∞–ø—É—Å–∫–∞–µ—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏',
        '–õ–µ–≤': '–°—Ç–∏–º—É–ª–∏—Ä—É–µ—Ç–µ –∂–µ–ª–∞–Ω–∏–µ –±—ã—Ç—å —á–∞—Å—Ç—å—é –≤–∞—à–µ–≥–æ –º–∏—Ä–∞'
    }
    return strategies.get(sign, '–ó–∞–∫—Ä–µ–ø–ª—è–µ—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å —á–µ—Ä–µ–∑ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥')

def get_avoid_actions(sign):
    avoids = {
        '–†–∞–∫': '1. –ù–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±–∏–¥—É –∏–ª–∏ desperation\n2. –ù–µ –ø–∏—Å–∞—Ç—å –ø–µ—Ä–≤–æ–π —Å –≤–æ–ø—Ä–æ—Å–æ–º "–ö–∞–∫ –¥–µ–ª–∞?"\n3. –ù–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –≤—Å–µ –∫–∞—Ä—Ç—ã —Å—Ä–∞–∑—É',
        '–°–∫–æ—Ä–ø–∏–æ–Ω': '1. –ù–µ –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –¥–æ—Å—Ç—É–ø–Ω–æ–π\n2. –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏\n3. –ù–µ —Ç–æ—Ä–æ–ø–∏—Ç—å —Å–æ–±—ã—Ç–∏—è',
        '–ë–ª–∏–∑–Ω–µ—Ü—ã': '1. –ù–µ –∑–∞–≤–∞–ª–∏–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏\n2. –ù–µ –±—ã—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–π\n3. –ù–µ —Ç—Ä–µ–±–æ–≤–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞',
        '–õ–µ–≤': '1. –ù–µ —É–Ω–∏–∂–∞—Ç—å—Å—è\n2. –ù–µ —Ç–µ—Ä—è—Ç—å —Å–≤–æ—ë –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–æ\n3. –ù–µ –ø—Ä–æ—è–≤–ª—è—Ç—å –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏–µ'
    }
    return avoids.get(sign, '1. –ù–µ –ø–∏—Å–∞—Ç—å –ø–µ—Ä–≤–æ–π —Å –ø—É—Å—Ç—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏\n2. –ù–µ –ø—Ä–æ—è–≤–ª—è—Ç—å –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏–µ\n3. –ù–µ —Ç–µ—Ä—è—Ç—å —Å–≤–æ—é —Ü–µ–Ω–Ω–æ—Å—Ç—å')

def get_overall_strategy(moon_sign, mars_sign):
    strategies = {
        '–†–∞–∫': '–±—ã—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –∑–∞–≥–∞–¥–∫–æ–π, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–æ–¥–∞—ë—Ç —Å–∏–≥–Ω–∞–ª—ã',
        '–°–∫–æ—Ä–ø–∏–æ–Ω': '—Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≥–ª—É–±–∏–Ω—É –∏ —Ç–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Ä–∞—Å–∫—Ä—ã–≤–∞—è —Å–ª–æ–∏',
        '–ë–ª–∏–∑–Ω–µ—Ü—ã': '–±—ã—Ç—å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ —Å—Ç–∏–º—É–ª–∏—Ä—É—é—â–µ–π –∏ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–π',
        '–õ–µ–≤': '–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ—é —Ü–µ–Ω–Ω–æ—Å—Ç—å, –Ω–æ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–µ–º–Ω–æ–≥–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–π'
    }
    return strategies.get(moon_sign, '—Å–æ—á–µ—Ç–∞–Ω–∏–µ –≤—ã–∑–æ–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏')

def get_strategic_analysis(question_text):
    """–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π —Ö–æ—Ä–∞—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑"""
    try:
        current_time = datetime.now()
        observer = ephem.Observer()
        observer.lat = '55.7558'
        observer.lon = '37.6173'  
        observer.date = current_time
        
        # –†–∞—Å—á–µ—Ç –≤—Å–µ—Ö –Ω—É–∂–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ç
        planets = {
            'moon': ephem.Moon(),
            'sun': ephem.Sun(), 
            'mars': ephem.Mars(),
            'venus': ephem.Venus(),
            'mercury': ephem.Mercury(),
            'jupiter': ephem.Jupiter()
        }
        
        for planet in planets.values():
            planet.compute(observer)
        
        # –ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–∏–π
        moon_sign = get_russian_zodiac(ephem.constellation(planets['moon'])[1])
        sun_sign = get_russian_zodiac(ephem.constellation(planets['sun'])[1])
        mars_sign = get_russian_zodiac(ephem.constellation(planets['mars'])[1])
        venus_sign = get_russian_zodiac(ephem.constellation(planets['venus'])[1])
        merc_sign = get_russian_zodiac(ephem.constellation(planets['mercury'])[1])
        jup_sign = get_russian_zodiac(ephem.constellation(planets['jupiter'])[1])
        
        analysis = generate_strategic_analysis(
            question_text, moon_sign, sun_sign, mars_sign, venus_sign, merc_sign, jup_sign
        )
        return analysis
        
    except Exception as e:
        return f"‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞: {str(e)}"

@bot.message_handler(func=lambda message: True)
def handle_message(message):
    if message.text.startswith('/'):
        if message.text == '/start':
            bot.reply_to(message, "üîÆ –Ø ‚Äî –•–æ—Ä–∞—Ä–Ω—ã–π –ò–º–ø–µ—Ä–∞—Ç–æ—Ä. –ó–∞–¥–∞–π —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å!")
        return
    
    analysis = get_strategic_analysis(message.text)
    bot.reply_to(message, analysis)

print("üîÑ –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π –±–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
while True:
    try:
        bot.polling(none_stop=True, interval=1)
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞: {e}")
        time.sleep(5)
