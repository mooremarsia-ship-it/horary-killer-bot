import telebot
import time
import random
import json
import os
from datetime import datetime, timedelta, timezone
from flask import Flask
import threading

print("üåå –ó–∞–ø—É—Å–∫–∞—é –•–æ—Ä–∞—Ä–Ω–æ–≥–æ –ò–º–ø–µ—Ä–∞—Ç–æ—Ä–∞...")

# –°–æ–∑–¥–∞–µ–º Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è
app = Flask(__name__)

@app.route('/')
def health_check():
    return "üîÑ –•–æ—Ä–∞—Ä–Ω—ã–π –ò–º–ø–µ—Ä–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç!", 200

def run_flask():
    print("üåê –ó–∞–ø—É—Å–∫–∞—é Flask —Å–µ—Ä–≤–µ—Ä...")
    app.run(host='0.0.0.0', port=5000, debug=False)

# –ó–∞–ø—É—Å–∫–∞–µ–º Flask –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
flask_thread = threading.Thread(target=run_flask, daemon=True)
flask_thread.start()

# –¢–æ–∫–µ–Ω –±–æ—Ç–∞
BOT_TOKEN = "7166686748:AAFnyfjq5UsunijP_p8HQiYeKHh3qoAM5RA"
bot = telebot.TeleBot(BOT_TOKEN)

# –í–ê–ñ–ù–û: –£–¥–∞–ª—è–µ–º –≤–µ–±—Ö—É–∫ —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
try:
    bot.remove_webhook()
    print("‚úÖ –í–µ–±—Ö—É–∫ —É–¥–∞–ª–µ–Ω")
    time.sleep(1)
except Exception as e:
    print(f"‚ÑπÔ∏è –ù–µ –±—ã–ª–æ –≤–µ–±—Ö—É–∫–∞: {e}")

class MysticEmperorAnalyst:
    def __init__(self):
        print("üîÆ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é –•–æ—Ä–∞—Ä–Ω–æ–≥–æ –ò–º–ø–µ—Ä–∞—Ç–æ—Ä–∞...")
        self.experience = 0
        self.learning_data = {}
        self._setup_files()
        self.load_learning_data()
        print("‚úÖ –•–æ—Ä–∞—Ä–Ω—ã–π –ò–º–ø–µ—Ä–∞—Ç–æ—Ä –≥–æ—Ç–æ–≤!")
    
    def _setup_files(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤"""
        try:
            if not os.path.exists('learning_data.json'):
                with open('learning_data.json', 'w', encoding='utf-8') as f:
                    json.dump({}, f, ensure_ascii=False, indent=2)
                print("‚úÖ –°–æ–∑–¥–∞–Ω learning_data.json")
            else:
                print("‚úÖ learning_data.json —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")
                
        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–π–ª–æ–≤: {e}")
    
    def load_learning_data(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è"""
        try:
            if os.path.exists('learning_data.json'):
                with open('learning_data.json', 'r', encoding='utf-8') as f:
                    self.learning_data = json.load(f)
                print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(self.learning_data)} –∑–∞–ø–∏—Å–µ–π –æ–±—É—á–µ–Ω–∏—è")
            else:
                self.learning_data = {}
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: {e}")
            self.learning_data = {}
    
    def save_learning_data(self):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–±—É—á–µ–Ω–∏—è"""
        try:
            with open('learning_data.json', 'w', encoding='utf-8') as f:
                json.dump(self.learning_data, f, ensure_ascii=False, indent=2)
        except:
            pass

    def get_mystic_greeting(self):
        """–ú–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ò–º–ø–µ—Ä–∞—Ç–æ—Ä–∞"""
        greetings = [
            "üåå *–Ø –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é —Ç–µ–±—è, –ò—Å–∫–∞—Ç–µ–ª—å!* –° –∫–∞–∫–∏–º –≤–æ–ø—Ä–æ—Å–æ–º —Ç—ã –ø—Ä–∏—à—ë–ª –∫–æ –º–Ω–µ —Å–µ–≥–æ–¥–Ω—è?",
            "‚ú® *–ü—Ä–µ–¥ –ª–∏–∫–æ–º –í–µ—á–Ω–æ—Å—Ç–∏ —Å–∫–ª–æ–Ω–∏—Å—å, –ü—É—Ç–Ω–∏–∫!* –ö–∞–∫–æ–π –≤–æ–ø—Ä–æ—Å –ø—Ä–∏–≤–µ–ª —Ç–µ–±—è –≤ –º–æ–∏ —á–µ—Ä—Ç–æ–≥–∏?",
            "üîÆ *–í —á–∞—Å, –∫–æ–≥–¥–∞ –∑–≤—ë–∑–¥—ã —à–µ–ø—á—É—Ç —Ç–∞–π–Ω—ã,* —è, –•–æ—Ä–∞—Ä–Ω—ã–π –ò–º–ø–µ—Ä–∞—Ç–æ—Ä, –≤–Ω–∏–º–∞—é —Ç–≤–æ–∏–º –≤–æ–ø—Ä–æ—Å–∞–º...",
            "üí´ *–ú–µ–∂ –º–∏—Ä–∞–º–∏ –±–ª—É–∂–¥–∞—è, —Ç—ã –Ω–∞—à–µ–ª –º–æ–π –ø–æ—Ä–æ–≥.* –ì–æ–≤–æ—Ä–∏, —á–µ–≥–æ –∂–µ–ª–∞–µ—Ç —Ç–≤–æ—è –¥—É—à–∞?",
            "üåô *–ü–æ–¥ –ø–æ–∫—Ä–æ–≤–æ–º –Ω–æ—á–∏ –∏ —Å–≤–µ—Ç–æ–º –∑–≤—ë–∑–¥,* —è –≤–Ω–µ–º–ª—é —Ç–≤–æ–∏–º —Å—Ç—Ä–µ–º–ª–µ–Ω–∏—è–º. –í —á–µ–º —Ç–≤–æ–π –≤–æ–ø—Ä–æ—Å?",
            "‚ö° *–°–∏–ª—ã –Ω–µ–±–µ—Å–Ω—ã–µ –Ω—ã–Ω–µ –ø—Ä–æ–±—É–¥–∏–ª–∏—Å—å!* –° –∫–∞–∫–∏–º –ø—Ä–æ—à–µ–Ω–∏–µ–º –æ–±—Ä–∞—â–∞–µ—à—å—Å—è –∫ –í—ã—Å—à–∏–º –°—Ñ–µ—Ä–∞–º?"
        ]
        return random.choice(greetings)

    def is_greeting_or_command(self, text):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ–º –∏–ª–∏ –∫–æ–º–∞–Ω–¥–æ–π"""
        text_lower = text.lower().strip()
        
        greetings = [
            '–∏–º–ø–µ—Ä–∞—Ç–æ—Ä', '–±–æ—Ç', '–ø—Ä–∏–≤–µ—Ç', '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π', '—Ö–∞–π', '—Å–∞–ª—é—Ç', 
            'start', 'help', '/start', '/help', '–Ω–∞—á–∞—Ç—å', '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ',
            '–¥–æ–±—Ä—ã–π –¥–µ–Ω—å', '–¥–æ–±—Ä—ã–π –≤–µ—á–µ—Ä', '–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ', 'hi', 'hello',
            '–∫—É', '—Å–∞–ª–∞–º', '–ø—Ä–∏–≤', '–ø—Ä–∏–≤–µ—Ç–∏–∫'
        ]
        
        return text_lower in greetings

    def is_real_question(self, text):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞—Å—Ç–æ—è—â–∏–º –≤–æ–ø—Ä–æ—Å–æ–º"""
        text_lower = text.lower().strip()
        
        if self.is_greeting_or_command(text_lower):
            return False
            
        question_keywords = [
            '–∫–æ–≥–¥–∞', '—á—Ç–æ', '–∫–∞–∫', '–ø–æ—á–µ–º—É', '–∑–∞—á–µ–º', '–±—É–¥–µ—Ç', '–µ—Å—Ç—å', '–±—É–¥–µ—Ç –ª–∏',
            '–º–Ω–µ', '–º–µ–Ω—è', '–º–æ–π', '–º–æ—è', '–º–æ–µ', '–º–æ–∏', 
            '–ª—é–±–æ–≤—å', '–¥–µ–Ω—å–≥–∏', '–æ—Ç–Ω–æ—à–µ–Ω–∏—è', '—Ä–∞–±–æ—Ç–∞', '–±—É–¥—É—â–µ–µ',
            '–≤—Å—Ç—Ä–µ—á—É', '–ø–æ–ª—É—á—É', '–∏–∑–º–µ–Ω–∏—Ç—Å—è', '–ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç',
            '–º–∏—Ö–∞–∏–ª', '–º–∏—à–∞', '–ø–µ—Ä–µ–µ–∑–¥', '–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ', '—Ñ–∏–Ω–∞–Ω—Å—ã'
        ]
        
        if len(text_lower) < 4:
            return False
            
        has_keywords = any(keyword in text_lower for keyword in question_keywords)
        has_question_mark = '?' in text_lower
        
        return has_keywords or has_question_mark

    def analyze_user_intent(self, question):
        """–ì–õ–£–ë–û–ö–û–ï —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–π"""
        question_lower = question.lower()
        
        print(f"üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –∏–Ω—Ç–µ–Ω—Ç –¥–ª—è: {question_lower}")
        
        # –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ –ú–∏—Ö–∞–∏–ª–∞
        if any(word in question_lower for word in ['–º–∏—Ö–∞–∏–ª', '–º–∏—à–∞', '–º–∏—Ö–∞–∏–ª–æ–º']):
            print("üéØ –†–∞—Å–ø–æ–∑–Ω–∞–Ω: MIKHAIL_RELATIONSHIP")
            return "MIKHAIL_RELATIONSHIP"
        
        # –ê–Ω–∞–ª–∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤ –¥–ª—è –ø–µ—Ä–µ–µ–∑–¥–∞
        elif any(word in question_lower for word in ['–¥–µ–Ω—å–≥–∏', '—Ñ–∏–Ω–∞–Ω—Å—ã', '—Å—É–º–º–∞', '–ø—Ä–∏–¥—É—Ç', '–∑–∞—Ä–∞–±–æ—Ç']):
            if any(word in question_lower for word in ['–ø–µ—Ä–µ–µ–∑–¥', '—É–µ—Ö–∞—Ç—å', '–≥–æ—Ä–æ–¥', '–ø—É—Ç–µ—à–µ—Å—Ç–≤']):
                print("üéØ –†–∞—Å–ø–æ–∑–Ω–∞–Ω: MONEY_FOR_TRAVEL")
                return "MONEY_FOR_TRAVEL"
            print("üéØ –†–∞—Å–ø–æ–∑–Ω–∞–Ω: FINANCE_DEEP")
            return "FINANCE_DEEP"
        
        # –ê–Ω–∞–ª–∏–∑ –ª—é–±–≤–∏ –¥–æ –∫–æ–Ω—Ü–∞ –≥–æ–¥–∞
        elif any(word in question_lower for word in ['–ª—é–±–æ–≤—å', '–æ—Ç–Ω–æ—à–µ–Ω', '—á—É–≤—Å—Ç–≤–∞', '–≤—Å—Ç—Ä–µ—á', '–ø–∞—Ä–µ–Ω—å', '–≤—Å—Ç—Ä–µ—á—É']):
            if '–¥–æ –∫–æ–Ω—Ü–∞ –≥–æ–¥–∞' in question_lower or '—á—Ç–æ –∂–¥–µ—Ç –≤ –ª—é–±–≤–∏' in question_lower:
                print("üéØ –†–∞—Å–ø–æ–∑–Ω–∞–Ω: LOVE_YEAR_END")
                return "LOVE_YEAR_END"
            print("üéØ –†–∞—Å–ø–æ–∑–Ω–∞–Ω: RELATIONSHIP_DEEP")
            return "RELATIONSHIP_DEEP"
        
        # –û–±—â–∏–π –∞–Ω–∞–ª–∏–∑
        else:
            print("üéØ –†–∞—Å–ø–æ–∑–Ω–∞–Ω: UNIVERSAL")
            return "UNIVERSAL"

    def generate_analysis(self, question, user_id=None, chat_type="private"):
        """–£–ú–ù–´–ô –∞–Ω–∞–ª–∏–∑ —Å –†–ê–ó–ù–´–ú–ò –æ—Ç–≤–µ—Ç–∞–º–∏"""
        
        intent = self.analyze_user_intent(question)
        print(f"üéØ –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ–Ω—Ç: {intent} –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞: {question}")
        
        # –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –ì–õ–£–ë–û–ö–ò–ï –û–¢–í–ï–¢–´
        if intent == "MIKHAIL_RELATIONSHIP":
            return self._get_mikhail_analysis(question)
        elif intent == "MONEY_FOR_TRAVEL":
            return self._get_money_travel_analysis(question)
        elif intent == "LOVE_YEAR_END":
            return self._get_love_year_end_analysis(question)
        
        # –û–ë–©–ò–ô –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó
        return self._get_universal_reading(question)

    def _get_love_year_end_analysis(self, question):
        """–°–ü–ï–¶–ò–ê–õ–¨–ù–´–ô –∞–Ω–∞–ª–∏–∑ –ª—é–±–≤–∏ –¥–æ –∫–æ–Ω—Ü–∞ –≥–æ–¥–∞"""
        current_time = datetime.now(timezone.utc) + timedelta(hours=3)
        time_str = current_time.strftime('%H:%M, %d %B %Y')
        
        analysis_text = f"""
*üíñ –•–û–†–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó –õ–Æ–ë–í–ò –î–û –ö–û–ù–¶–ê –ì–û–î–ê*

*–í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞:* {time_str}
*–í–æ–ø—Ä–æ—Å —Å–µ—Ä–¥—Ü–∞:* ¬´{question}¬ª

---

*üîç –ì–õ–£–ë–ò–ù–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –í–°–ï–• –°–§–ï–† –ñ–ò–ó–ù–ò:*

*üåà –ö–õ–Æ–ß–ï–í–´–ï –°–§–ï–†–´ –ñ–ò–ó–ù–ò:*

*üíñ –õ–ò–ß–ù–´–ï –û–¢–ù–û–®–ï–ù–ò–Ø:*
‚Ä¢ *–ù–û–Ø–ë–†–¨:* –ì–ª—É–±–æ–∫–æ–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ—á–∏—â–µ–Ω–∏–µ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
‚Ä¢ *–î–ï–ö–ê–ë–†–¨:* –°—É–¥—å–±–æ–Ω–æ—Å–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏ –∏ –Ω–æ–≤—ã–µ –Ω–∞—á–∞–ª–∞
‚Ä¢ *–≠–ù–ï–†–ì–ï–¢–ò–ö–ê:* –í–∞—à–∞ –ª—é–±–æ–≤–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –Ω–∞ –ø–∏–∫–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

*üí∞ –§–ò–ù–ê–ù–°–´ –ò –ü–†–û–§–ï–°–°–ò–Ø:*
‚Ä¢ *–°–í–Ø–ó–¨ –° –õ–Æ–ë–û–í–¨–Æ:* –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ—Ç –¥–æ—Å—Ç–æ–π–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
‚Ä¢ *–ü–†–û–§–ï–°–°–ò–Ø:* –¢–≤–æ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –ø—Ä–∏–≤–µ–¥—É—Ç –∫ —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞–º

*üé® –¢–í–û–†–ß–ï–°–¢–í–û –ò –°–ê–ú–û–†–ï–ê–õ–ò–ó–ê–¶–ò–Ø:*
‚Ä¢ *–ü–û–¢–ï–ù–¶–ò–ê–õ:* –í–∞—à–∞ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ
‚Ä¢ *–≠–ù–ï–†–ì–ò–Ø:* –°–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∫–∞–∫ –º–∞–≥–Ω–∏—Ç –¥–ª—è —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π –¥—É—à–∏

*üåå –î–£–•–û–í–ù–û–ï –†–ê–ó–í–ò–¢–ò–ï:*
‚Ä¢ *–ü–£–¢–¨:* –ì–æ—Ç–æ–≤—å—Ç–µ—Å—å –∫ –≥–ª—É–±–æ–∫–∏–º –∏–Ω—Å–∞–π—Ç–∞–º –æ –ø—Ä–∏—Ä–æ–¥–µ –ª—é–±–≤–∏
‚Ä¢ *–û–°–û–ó–ù–ê–ù–ò–ï:* –ò—Å—Ç–∏–Ω–Ω–∞—è –ª—é–±–æ–≤—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Å–∞–º–æ–ø—Ä–∏–Ω—è—Ç–∏—è

---

*üöß –í–´–Ø–í–õ–ï–ù–ù–´–ï –ë–õ–û–ö–ò –ò –ü–†–ï–ü–Ø–¢–°–¢–í–ò–Ø:*
‚Ä¢ *–°–¢–†–ê–• –ë–õ–ò–ó–û–°–¢–ò:* –ú–æ–∂–µ—Ç –º–µ—à–∞—Ç—å —Å–æ–∑–¥–∞—Ç—å –≥–ª—É–±–æ–∫—É—é —Å–≤—è–∑—å
‚Ä¢ *–û–ñ–ò–î–ê–ù–ò–Ø:* –û—Å–≤–æ–±–æ–¥–∏—Ç–µ—Å—å –æ—Ç —à–∞–±–ª–æ–Ω–æ–≤ - –ª—é–±–æ–≤—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ

*üå† –î–£–•–û–í–ù–´–ï –ò–ù–°–ê–ô–¢–´ –î–õ–Ø –í–ê–°:*
‚Ä¢ *üíé –í–´–°–®–ï–ï –ó–ù–ê–ù–ò–ï:* –í—ã –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç–µ —Ç–æ–≥–æ, –∫–æ–≥–æ —á—É–≤—Å—Ç–≤—É–µ—Ç–µ –¥–æ—Å—Ç–æ–π–Ω–æ–π
‚Ä¢ *‚ú® –ö–ê–†–ú–ò–ß–ï–°–ö–ò–ô –£–†–û–ö:* –≠—Ç–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –æ—Ç—Ä–∞–∑—è—Ç –≤–∞—à–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ —Å–µ–±–µ

---

*üí´ –í–ï–†–î–ò–ö–¢ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:*

*üåü –û–ë–©–ò–ô –í–ï–†–î–ò–ö–¢:*
–î–æ –∫–æ–Ω—Ü–∞ –≥–æ–¥–∞ –≤–∞—Å –∂–¥—É—Ç –∑–Ω–∞—á–∏–º—ã–µ –≤—Å—Ç—Ä–µ—á–∏ –∏ –≥–ª—É–±–æ–∫–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç–∏—è. –î–µ–∫–∞–±—Ä—å —Å—Ç–∞–Ω–µ—Ç –ø–µ—Ä–µ–ª–æ–º–Ω—ã–º –º–µ—Å—è—Ü–µ–º –¥–ª—è –≤–∞—à–µ–π –ª–∏—á–Ω–æ–π –∂–∏–∑–Ω–∏.

*üíñ –û–°–û–ë–ï–ù–ù–û –í–ê–ñ–ù–´–ï –î–ê–¢–´:*
‚Ä¢ *7-15 –¥–µ–∫–∞–±—Ä—è:* –ü–µ—Ä–∏–æ–¥ —Å—É–¥—å–±–æ–Ω–æ—Å–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á
‚Ä¢ *21 –¥–µ–∫–∞–±—Ä—è:* –ó–∏–º–Ω–µ–µ —Å–æ–ª–Ω—Ü–µ—Å—Ç–æ—è–Ω–∏–µ - –ø–µ—Ä–µ–ª–æ–º–Ω—ã–π –º–æ–º–µ–Ω—Ç
‚Ä¢ *29 –¥–µ–∫–∞–±—Ä—è:* –ù–æ–≤–æ–ª—É–Ω–∏–µ - –Ω–æ–≤—ã–µ –Ω–∞—á–∞–ª–∞ –≤ –ª—é–±–≤–∏

*üí´ –û–ë–©–ê–Ø –≠–ù–ï–†–ì–ï–¢–ò–ö–ê:*
–í–∞—à–µ —Å–µ—Ä–¥—Ü–µ –≥–æ—Ç–æ–≤–æ –∫ –Ω–∞—Å—Ç–æ—è—â–µ–π –ª—é–±–≤–∏. –ó–≤–µ–∑–¥—ã –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –¥–ª—è –≥–ª—É–±–æ–∫–∏—Ö —Å–µ—Ä–¥–µ—á–Ω—ã—Ö —Å–≤—è–∑–µ–π.
"""
        
        verdict = "üíñ"
        strategy = """*üéØ –°–¢–†–ê–¢–ï–ì–ò–Ø –û–¢ –•–û–†–ê–†–ù–û–ì–û –ò–ú–ü–ï–†–ê–¢–û–†–ê:*

‚Ä¢ *–û–¢–ö–†–û–ô–¢–ï –°–ï–†–î–¶–ï:* –ü–æ—Å–µ—â–∞–π—Ç–µ –º–µ—Å—Ç–∞, –≥–¥–µ –º–æ–∂–µ—Ç–µ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –µ–¥–∏–Ω–æ–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–≤
‚Ä¢ *–ò–°–¶–ï–õ–ò–¢–ï –ü–†–û–®–õ–û–ï:* –ù–∞–ø–∏—à–∏—Ç–µ –ø–∏—Å—å–º–∞ –ø—Ä–æ—â–µ–Ω–∏—è –≤—Å–µ–º –±—ã–≤—à–∏–º –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º
‚Ä¢ *–†–ê–ë–û–¢–ê–ô–¢–ï –° –°–ê–ú–û–û–¶–ï–ù–ö–û–ê:* –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –Ω–∞–ø–æ–º–∏–Ω–∞–π—Ç–µ —Å–µ–±–µ –æ —Å–≤–æ–µ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏
‚Ä¢ *–ü–†–ê–ö–¢–ò–ö–£–ô–¢–ï –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Æ:* –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–π—Ç–µ –∏–¥–µ–∞–ª—å–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫–∞–∂–¥—ã–π –≤–µ—á–µ—Ä
‚Ä¢ *–ù–û–°–ò–¢–ï –†–û–ó–û–í–´–ô –ö–í–ê–†–¶:* –≠—Ç–æ—Ç –∫–∞–º–µ–Ω—å —É—Å–∏–ª–∏–≤–∞–µ—Ç –ª—é–±–æ–≤–Ω—É—é —ç–Ω–µ—Ä–≥–∏—é

*üîÆ –î–£–•–û–í–ù–´–ï –ü–†–ê–ö–¢–ò–ö–ò:*
‚Ä¢ *–ú–ï–î–ò–¢–ê–¶–ò–Ø –°–ï–†–î–¶–ê:* –ö–∞–∂–¥–æ–µ —É—Ç—Ä–æ –Ω–∞–ø—Ä–∞–≤–ª—è–π—Ç–µ –ª—é–±–æ–≤—å –≤ —Å–≤–æ–µ —Å–µ—Ä–¥—Ü–µ
‚Ä¢ *–õ–£–ù–ù–´–ï –†–ò–¢–£–ê–õ–´:* –í –ø–æ–ª–Ω–æ–ª—É–Ω–∏–µ –∑–∞–≥–∞–¥—ã–≤–∞–π—Ç–µ –∂–µ–ª–∞–Ω–∏—è –æ –ª—é–±–≤–∏"""

        return verdict, analysis_text, strategy

    def _get_universal_reading(self, question):
        """–£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Å—Ñ–µ—Ä –∂–∏–∑–Ω–∏"""
        current_time = datetime.now(timezone.utc) + timedelta(hours=3)
        time_str = current_time.strftime('%H:%M, %d %B %Y')
        
        analysis_text = f"""
*üåå –•–û–†–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó –í–´–°–®–ò–• –°–§–ï–†*

*–í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞:* {time_str}
*–í–æ–ø—Ä–æ—Å –∏—Å–∫–∞—Ç–µ–ª—è:* ¬´{question}¬ª

---

*üîç –ì–õ–£–ë–ò–ù–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –í–°–ï–• –°–§–ï–† –ñ–ò–ó–ù–ò:*

*üåà –ö–õ–Æ–ß–ï–í–´–ï –°–§–ï–†–´ –ñ–ò–ó–ù–ò:*

*üíñ –õ–ò–ß–ù–´–ï –û–¢–ù–û–®–ï–ù–ò–Ø:*
‚Ä¢ *üí´ –û–ë–©–ê–Ø –î–ò–ù–ê–ú–ò–ö–ê:* –û—Ç–Ω–æ—à–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Å—Ç–∞–¥–∏–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
‚Ä¢ *‚ö° –≠–ù–ï–†–ì–ï–¢–ò–ö–ê:* –ì–ª—É–±–æ–∫–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ç—Ä–µ–±—É—é—Ç –æ—Å–æ–∑–Ω–∞–Ω–∏—è

*üí∞ –§–ò–ù–ê–ù–°–´ –ò –ü–†–û–§–ï–°–°–ò–Ø:*
‚Ä¢ *üí° –°–¢–†–ê–¢–ï–ì–ò–Ø:* –ó–∞–≤–µ—Ä—à–∏—Ç–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–µ–ª–∞ - –æ—Ç–∫—Ä–æ—é—Ç—Å—è –Ω–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏
‚Ä¢ *üå± –ü–û–¢–ï–ù–¶–ò–ê–õ:* –ù–∞—Ö–æ–¥–∏—Ç–µ—Å—å –Ω–∞ –ø–æ—Ä–æ–≥–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ä—ã–≤–∞

*üé® –¢–í–û–†–ß–ï–°–¢–í–û –ò –°–ê–ú–û–†–ï–ê–õ–ò–ó–ê–¶–ò–Ø:*
‚Ä¢ *–ü–û–¢–ï–ù–¶–ò–ê–õ:* –í—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –Ω–∞ –ø–æ—Ä–æ–≥–µ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ä—ã–≤–∞
‚Ä¢ *–≠–ù–ï–†–ì–ò–Ø:* –í–∞—à–∞ —Å–æ–∑–∏–¥–∞—Ç–µ–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è —Å–µ–π—á–∞—Å –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–∞

*üåå –î–£–•–û–í–ù–û–ï –†–ê–ó–í–ò–¢–ò–ï:*
‚Ä¢ *–ü–£–¢–¨:* –í—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç–µ –≤–∞–∂–Ω—ã–π —ç—Ç–∞–ø –¥—É—Ö–æ–≤–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞
‚Ä¢ *–û–°–û–ó–ù–ê–ù–ò–ï:* –ì–æ—Ç–æ–≤—å—Ç–µ—Å—å –∫ –≥–ª—É–±–æ–∫–∏–º –∏–Ω—Å–∞–π—Ç–∞–º –æ —Å–≤–æ–µ–º –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏

---

*üöß –í–´–Ø–í–õ–ï–ù–ù–´–ï –ë–õ–û–ö–ò –ò –ü–†–ï–ü–Ø–¢–°–¢–í–ò–Ø:*
‚Ä¢ *–ó–ù–ê–ß–ò–ú–´–• –ë–õ–û–ö–û–í –ù–ï –í–´–Ø–í–õ–ï–ù–û* - —ç–Ω–µ—Ä–≥–∏—è —Ç–µ—á–µ—Ç —Å–≤–æ–±–æ–¥–Ω–æ

*üå† –î–£–•–û–í–ù–´–ï –ò–ù–°–ê–ô–¢–´ –î–õ–Ø –í–ê–°:*
‚Ä¢ *üåå –í–ê–ñ–ù–û–ï –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï:* –í—ã - –¢–í–û–†–ï–¶ —Å–≤–æ–µ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏
‚Ä¢ *üí´ –í–ê–®–ï –í–´–°–®–ï–ï –Ø:* –í—Å–µ–≥–¥–∞ –∑–Ω–∞–µ—Ç –æ—Ç–≤–µ—Ç - –¥–æ–≤–µ—Ä—è–π—Ç–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –≥–æ–ª–æ—Å—É

---

*üí´ –í–ï–†–î–ò–ö–¢ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:*

*üåü –û–ë–©–ò–ô –í–ï–†–î–ò–ö–¢:*

*üí´ –û–ë–©–ê–Ø –≠–ù–ï–†–ì–ï–¢–ò–ö–ê:*
–í–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–∑–µ –º–æ—â–Ω–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏. –¢–µ–∫—É—â–∏–µ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ—Ç–æ–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤–∞—à–∏ —Å–∞–º—ã–µ —Å–º–µ–ª—ã–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è. –î–æ–≤–µ—Ä—è–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—É!
"""
        
        verdict = "üåå"
        strategy = """*üéØ –°–¢–†–ê–¢–ï–ì–ò–Ø –û–¢ –•–û–†–ê–†–ù–û–ì–û –ò–ú–ü–ï–†–ê–¢–û–†–ê:*

‚Ä¢ *–ì–õ–ê–í–ù–û–ï:* –ü–æ–º–Ω–∏—Ç–µ - –í–´ –¢–í–û–†–ï–¶ —Å–≤–æ–µ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏
‚Ä¢ *–î–£–•–û–í–ù–ê–Ø –ü–†–ê–ö–¢–ò–ö–ê:* –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç–µ –∑–∞ –≤—Å–µ, —á—Ç–æ –∏–º–µ–µ—Ç–µ
‚Ä¢ *–°–õ–£–®–ê–ô–¢–ï –°–ï–†–î–¶–ï:* –í–∞—à–µ –≤—ã—Å—à–µ–µ –Ø –∑–Ω–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã
‚Ä¢ *–ë–£–î–¨–¢–ï –û–¢–ö–†–´–¢–´:* –°–∏–Ω—Ö—Ä–æ–Ω–∏—á–Ω–æ—Å—Ç–∏ –≤–µ–¥—É—Ç –≤–∞—Å –ø–æ –≤–µ—Ä–Ω–æ–º—É –ø—É—Ç–∏
‚Ä¢ *–î–û–í–ï–†–Ø–ô–¢–ï:* –í—Å–µ unfolds perfectly –¥–ª—è –≤–∞—à–µ–≥–æ –≤—ã—Å—à–µ–≥–æ –±–ª–∞–≥–∞"""

        return verdict, analysis_text, strategy

    def _get_mikhail_analysis(self, question):
        """–°–ü–ï–¶–ò–ê–õ–¨–ù–´–ô –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ –ú–∏—Ö–∞–∏–ª–∞"""
        current_time = datetime.now(timezone.utc) + timedelta(hours=3)
        time_str = current_time.strftime('%H:%M, %d %B %Y')
        
        analysis_text = f"""
*üåå –•–û–†–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó –û–¢–ù–û–®–ï–ù–ò–ô –° –ú–ò–•–ê–ò–õ–û–ú*

*–í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞:* {time_str}
*–í–æ–ø—Ä–æ—Å —Å–µ—Ä–¥—Ü–∞:* ¬´{question}¬ª

---

*üîç –ì–õ–£–ë–ò–ù–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –í–°–ï–• –°–§–ï–† –ñ–ò–ó–ù–ò:*

*üåà –ö–õ–Æ–ß–ï–í–´–ï –°–§–ï–†–´ –ñ–ò–ó–ù–ò:*

*üíñ –õ–ò–ß–ù–´–ï –û–¢–ù–û–®–ï–ù–ò–Ø:*
‚Ä¢ *üíé –û–¢–ù–û–®–ï–ù–ò–Ø –° –ú–ò–•–ê–ò–õ–û–ú:* –≠—Ç–æ –∑–µ—Ä–∫–∞–ª–æ –≤–∞—à–∏—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚Ä¢ *üí° –ò–ù–°–ê–ô–¢:* –í–æ–∑–º–æ–∂–Ω–æ, –≤–∞–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è —Å –ú–∏—Ö–∞–∏–ª–∞ –Ω–∞ —Å–µ–±—è
‚Ä¢ *üîÑ –ü–ê–¢–¢–ï–†–ù:* –≠—Ç–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —É—Ä–æ–∫–∏ —Å–∞–º–æ–ª—é–±–∏—è

*üí∞ –§–ò–ù–ê–ù–°–´ –ò –ü–†–û–§–ï–°–°–ò–Ø:*
‚Ä¢ *–°–í–Ø–ó–¨:* –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —É—Å–∏–ª–∏—Ç –≤–∞—à—É –ø–æ–∑–∏—Ü–∏—é –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö
‚Ä¢ *–§–û–ö–£–°:* –†–∞–∑–≤–∏–≤–∞–π—Ç–µ —Å–≤–æ–∏ —Ç–∞–ª–∞–Ω—Ç—ã –≤–Ω–µ —ç—Ç–æ–π —Å–≤—è–∑–∏

*üé® –¢–í–û–†–ß–ï–°–¢–í–û –ò –°–ê–ú–û–†–ï–ê–õ–ò–ó–ê–¶–ò–Ø:*
‚Ä¢ *–ü–û–¢–ï–ù–¶–ò–ê–õ:* –í–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–∏
‚Ä¢ *–≠–ù–ï–†–ì–ò–Ø:* –ù–∞–ø—Ä–∞–≤—å—Ç–µ —Å–æ–∑–∏–¥–∞—Ç–µ–ª—å–Ω—É—é —Å–∏–ª—É –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã

*üåå –î–£–•–û–í–ù–û–ï –†–ê–ó–í–ò–¢–ò–ï:*
‚Ä¢ *–ü–£–¢–¨:* –≠—Ç–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è - –≤–∞—à –∫–∞—Ä–º–∏—á–µ—Å–∫–∏–π —É—Ä–æ–∫
‚Ä¢ *–û–°–û–ó–ù–ê–ù–ò–ï:* –ò—Å—Ç–∏–Ω–Ω–∞—è –ª—é–±–æ–≤—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Å–∞–º–æ–ª—é–±–∏—è

---

*üöß –í–´–Ø–í–õ–ï–ù–ù–´–ï –ë–õ–û–ö–ò –ò –ü–†–ï–ü–Ø–¢–°–¢–í–ò–Ø:*
‚Ä¢ *–≠–ú–û–¶–ò–û–ù–ê–õ–¨–ù–ê–Ø –ü–†–ò–í–Ø–ó–ê–ù–ù–û–°–¢–¨* - –≤–æ–∑–º–æ–∂–Ω–æ, –≤—ã –æ—Ç–¥–∞–µ—Ç–µ —Å–≤–æ—é —ç–Ω–µ—Ä–≥–∏—é –≤–æ–≤–Ω–µ
‚Ä¢ *–ù–ï–î–û–û–¶–ï–ù–ö–ê –°–ï–ë–Ø* - —Å—Ç–∞–≤–∏—Ç–µ —á—É–∂–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤—ã—à–µ —Å–≤–æ–∏—Ö

*üå† –î–£–•–û–í–ù–´–ï –ò–ù–°–ê–ô–¢–´ –î–õ–Ø –í–ê–°:*
‚Ä¢ *üíé –ì–õ–£–ë–û–ö–ò–ô –ò–ù–°–ê–ô–¢:* –û—Ç–Ω–æ—à–µ–Ω–∏—è —Å –ú–∏—Ö–∞–∏–ª–æ–º - —ç—Ç–æ –∑–µ—Ä–∫–∞–ª–æ, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–µ–µ –≤–∞–º —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –∏—Å—Ü–µ–ª–∏—Ç—å –≤ —Å–µ–±–µ
‚Ä¢ *üåü –î–£–•–û–í–ù–´–ô –£–†–û–ö:* –ù–∞—É—á–∏—Ç—å—Å—è –ª—é–±–∏—Ç—å —Å–µ–±—è —Ç–∞–∫, –∫–∞–∫ —Ö–æ—Ç–∏—Ç–µ –±—ã—Ç—å –ª—é–±–∏–º–æ–π

---

*üí´ –í–ï–†–î–ò–ö–¢ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:*

*üåü –û–ë–©–ò–ô –í–ï–†–î–ò–ö–¢:*
–≠—Ç–∞ —Å–≤—è–∑—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–º –≤–∞–∂–Ω—ã–µ —É—Ä–æ–∫–∏ —Å–∞–º–æ–ª—é–±–∏—è –∏ —Å–∞–º–æ—Ü–µ–Ω–Ω–æ—Å—Ç–∏. –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ñ–æ–∫—É—Å —Å –ú–∏—Ö–∞–∏–ª–∞ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ.

*üí´ –û–ë–©–ê–Ø –≠–ù–ï–†–ì–ï–¢–ò–ö–ê:*
–ö–æ–≥–¥–∞ –≤—ã –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ—Å—å –ª—é–±–æ–≤—å—é –∫ —Å–µ–±–µ, –≤—Å–µ –≤–Ω–µ—à–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—è—Ç—Å—è.
"""
        
        verdict = "üíñ"
        strategy = """*üéØ –°–¢–†–ê–¢–ï–ì–ò–Ø –û–¢ –•–û–†–ê–†–ù–û–ì–û –ò–ú–ü–ï–†–ê–¢–û–†–ê:*

‚Ä¢ *–°–ê–ú–û–õ–Æ–ë–ò–ï:* –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –∑–∞–±–æ—Ç—É –æ —Å–µ–±–µ
‚Ä¢ *–≠–ù–ï–†–ì–ï–¢–ò–ß–ï–°–ö–ê–Ø –ì–ò–ì–ò–ï–ù–ê:* –í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ —Å–≤–æ—é —ç–Ω–µ—Ä–≥–∏—é —á–µ—Ä–µ–∑ –º–µ–¥–∏—Ç–∞—Ü–∏—é  
‚Ä¢ *–ì–†–ê–ù–ò–¶–´:* –£—á–∏—Ç–µ—Å—å –≥–æ–≤–æ—Ä–∏—Ç—å "–Ω–µ—Ç" –∫–æ–≥–¥–∞ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
‚Ä¢ *–§–û–ö–£–°:* –†–∞–∑–≤–∏–≤–∞–π—Ç–µ —Å–≤–æ–∏ —Ç–∞–ª–∞–Ω—Ç—ã –∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã –≤–Ω–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π
‚Ä¢ *–î–û–í–ï–†–ò–ï:* –í–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ unfolds perfectly –¥–ª—è –≤–∞—à–µ–≥–æ –≤—ã—Å—à–µ–≥–æ –±–ª–∞–≥–∞"""

        return verdict, analysis_text, strategy

    def _get_money_travel_analysis(self, question):
        """–°–ü–ï–¶–ò–ê–õ–¨–ù–´–ô –∞–Ω–∞–ª–∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤ –¥–ª—è –ø–µ—Ä–µ–µ–∑–¥–∞"""
        current_time = datetime.now(timezone.utc) + timedelta(hours=3)
        time_str = current_time.strftime('%H:%M, %d %B %Y')
        
        analysis_text = f"""
*üí∞ –•–û–†–ê–†–ù–´–ô –§–ò–ù–ê–ù–°–û–í–´–ô –ê–ù–ê–õ–ò–ó –î–õ–Ø –ü–ï–†–ï–ï–ó–î–ê*

*–í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞:* {time_str}
*–í–æ–ø—Ä–æ—Å –∏–∑–æ–±–∏–ª–∏—è:* ¬´{question}¬ª

---

*üîç –ì–õ–£–ë–ò–ù–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –í–°–ï–• –°–§–ï–† –ñ–ò–ó–ù–ò:*

*üåà –ö–õ–Æ–ß–ï–í–´–ï –°–§–ï–†–´ –ñ–ò–ó–ù–ò:*

*üíñ –õ–ò–ß–ù–´–ï –û–¢–ù–û–®–ï–ù–ò–Ø:*
‚Ä¢ *–°–í–Ø–ó–¨:* –ü–µ—Ä–µ–µ–∑–¥ —É–∫—Ä–µ–ø–∏—Ç –≤–∞–∂–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è
‚Ä¢ *–≠–ù–ï–†–ì–ï–¢–ò–ö–ê:* –ù–æ–≤–æ–µ –º–µ—Å—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞

*üí∞ –§–ò–ù–ê–ù–°–´ –ò –ü–†–û–§–ï–°–°–ò–Ø:*
‚Ä¢ *‚úàÔ∏è –î–õ–Ø –ü–ï–†–ï–ï–ó–î–ê:* –î–µ–Ω—å–≥–∏ –ø—Ä–∏–¥—É—Ç –∏–º–µ–Ω–Ω–æ –¥–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏
‚Ä¢ *üíé –ò–°–¢–û–ß–ù–ò–ö–ò:* –°—Ç–∞—Ä—ã–µ –ø—Ä–æ–µ–∫—Ç—ã, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ü–∏–∫–ª–æ–≤
‚Ä¢ *üìÖ –°–†–û–ö–ò:* –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –∞–∫—Ç–∏–≤–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è

*üé® –¢–í–û–†–ß–ï–°–¢–í–û –ò –°–ê–ú–û–†–ï–ê–õ–ò–ó–ê–¶–ò–Ø:*
‚Ä¢ *–ü–û–¢–ï–ù–¶–ò–ê–õ:* –ù–æ–≤–æ–µ –º–µ—Å—Ç–æ —Ä–∞—Å–∫—Ä–æ–µ—Ç –≤–∞—à–∏ —Ç–∞–ª–∞–Ω—Ç—ã
‚Ä¢ *–≠–ù–ï–†–ì–ò–Ø:* –°–º–µ–Ω–∞ –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∏ —É—Å–∏–ª–∏—Ç —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–æ–∫

*üåå –î–£–•–û–í–ù–û–ï –†–ê–ó–í–ò–¢–ò–ï:*
‚Ä¢ *–ü–£–¢–¨:* –ü–µ—Ä–µ–µ–∑–¥ –∫–∞–∫ —ç—Ç–∞–ø –¥—É—Ö–æ–≤–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞
‚Ä¢ *–û–°–û–ó–ù–ê–ù–ò–ï:* –ö–∞–∂–¥–æ–µ –º–µ—Å—Ç–æ –¥–∞–µ—Ç —Å–≤–æ–∏ —É—Ä–æ–∫–∏

---

*üöß –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ï–ü–Ø–¢–°–¢–í–ò–Ø:*
‚Ä¢ *–ó–ê–í–ï–†–®–ï–ù–ò–ï –¶–ò–ö–õ–û–í* - –≤–∞–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –≤—Å–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–µ–ª–∞
‚Ä¢ *–≠–ú–û–¶–ò–û–ù–ê–õ–¨–ù–´–ï –ë–õ–û–ö–ò* - —Å—Ç—Ä–∞—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å

*üå† –î–£–•–û–í–ù–´–ï –ò–ù–°–ê–ô–¢–´ –î–õ–Ø –í–ê–°:*
‚Ä¢ *üíé –í–´–°–®–ï–ï –ó–ù–ê–ù–ò–ï:* –î–µ–Ω—å–≥–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∞—à–∏—Ö —Ü–µ–ª–µ–π
‚Ä¢ *‚ú® –ö–ê–†–ú–ò–ß–ï–°–ö–ò–ô –£–†–û–ö:* –ò–∑–æ–±–∏–ª–∏–µ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞–º–µ—Ä–µ–Ω–∏—è–º–∏

---

*üí´ –í–ï–†–î–ò–ö–¢ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:*

*üåü –û–ë–©–ò–ô –í–ï–†–î–ò–ö–¢:*
–î–∞, —É –≤–∞—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥ –¥–ª—è –ø–µ—Ä–µ–µ–∑–¥–∞. –î–µ–Ω—å–≥–∏ –ø—Ä–∏–¥—É—Ç —Å–µ—Ä–∏–µ–π –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π –≤ –±–ª–∏–∂–∞–π—à–∏–µ –Ω–µ–¥–µ–ª–∏.

*üí´ –û–ë–©–ê–Ø –≠–ù–ï–†–ì–ï–¢–ò–ö–ê:*
–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤–∞—à–∏ —Ü–µ–ª–∏ –ø–µ—Ä–µ–µ–∑–¥–∞. –ó–∞–≤–µ—Ä—à–∞–π—Ç–µ —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ–µ–∫—Ç—ã - —ç—Ç–æ –æ—Ç–∫—Ä–æ–µ—Ç –Ω–æ–≤—ã–µ –¥–µ–Ω–µ–∂–Ω—ã–µ –∫–∞–Ω–∞–ª—ã.
"""
        
        verdict = "üí∞"
        strategy = """*üéØ –°–¢–†–ê–¢–ï–ì–ò–Ø –û–¢ –•–û–†–ê–†–ù–û–ì–û –ò–ú–ü–ï–†–ê–¢–û–†–ê:*

‚Ä¢ *–î–û 25.11:* –ó–∞–∫—Ä–æ–π—Ç–µ –≤—Å–µ –¥–æ–ª–≥–∏ –∏ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã
‚Ä¢ *–§–ò–ù–ê–ù–°–û–í–ê–Ø –ß–ò–°–¢–ö–ê:* –ü—Ä–∏–≤–µ–¥–∏—Ç–µ –≤ –ø–æ—Ä—è–¥–æ–∫ –≤—Å–µ –¥–µ–Ω–µ–∂–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
‚Ä¢ *–ü–û–î–ì–û–¢–û–í–ö–ê:* –ù–∞—á–Ω–∏—Ç–µ —Å–æ–±–∏—Ä–∞—Ç—å –≤–µ—â–∏ - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –≤–Ω–µ–∑–∞–ø–Ω–æ
‚Ä¢ *–°–ï–¢–¨:* –°–æ–æ–±—â–∏—Ç–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º –ª—é–¥—è–º –æ —Å–≤–æ–∏—Ö –ø–ª–∞–Ω–∞—Ö
‚Ä¢ *–î–û–í–ï–†–ò–ï:* –í–µ—Ä—å—Ç–µ –≤ –∏–∑–æ–±–∏–ª–∏–µ - –¥–µ–Ω—å–≥–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∞—à–∏—Ö —Ü–µ–ª–µ–π"""

        return verdict, analysis_text, strategy

# –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
analyst = MysticEmperorAnalyst()

# –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–û–ë–©–ï–ù–ò–ô
@bot.message_handler(commands=['start', 'help'])
def send_welcome(message):
    chat_type = "private" if message.chat.type == "private" else "group"
    
    greeting = analyst.get_mystic_greeting()
    
    if chat_type == "private":
        response = f"{greeting}\n\n*–ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å –æ:*\n‚Ä¢ üíñ –õ—é–±–≤–∏ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö\n‚Ä¢ üí∞ –§–∏–Ω–∞–Ω—Å–∞—Ö –∏ –∏–∑–æ–±–∏–ª–∏–∏  \n‚Ä¢ üåå –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –∏ —Å—É–¥—å–±–µ\n‚Ä¢ üîÆ –ë—É–¥—É—â–µ–º –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö\n\n*–ü—Ä–∏–º–µ—Ä:* ¬´–ß—Ç–æ –º–µ–Ω—è –∂–¥–µ—Ç –≤ –ª—é–±–≤–∏ –¥–æ –∫–æ–Ω—Ü–∞ –≥–æ–¥–∞?¬ª"
    else:
        response = f"{greeting}\n\nüí¨ *–ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å –∑–¥–µ—Å—å*\nüîí *–ò–ª–∏ '–õ–∏—á–Ω–æ–µ [–≤–æ–ø—Ä–æ—Å]' –¥–ª—è —Ç–∞–π–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞*"
    
    bot.reply_to(message, response, parse_mode='Markdown')

@bot.message_handler(func=lambda message: True)
def handle_all_messages(message):
    try:
        user_id = message.from_user.id
        text = message.text.strip()
        chat_type = "private" if message.chat.type == "private" else "group"
        
        print(f"üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ: '{text}' –≤ —á–∞—Ç–µ: {chat_type}")
        
        # –ü–†–û–í–ï–†–ö–ê - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–ª–∏ –∫–æ–º–∞–Ω–¥–∞
        if analyst.is_greeting_or_command(text):
            print(f"üéØ –†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ: '{text}'")
            greeting = analyst.get_mystic_greeting()
            if chat_type == "private":
                response = f"{greeting}\n\n*–ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å –æ:*\n‚Ä¢ üíñ –õ—é–±–≤–∏ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö\n‚Ä¢ üí∞ –§–∏–Ω–∞–Ω—Å–∞—Ö –∏ –∏–∑–æ–±–∏–ª–∏–∏  \n‚Ä¢ üåå –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –∏ —Å—É–¥—å–±–µ"
            else:
                response = f"{greeting}\n\nüí¨ *–ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å –∑–¥–µ—Å—å*\nüîí *–ò–ª–∏ '–õ–∏—á–Ω–æ–µ [–≤–æ–ø—Ä–æ—Å]' –¥–ª—è —Ç–∞–π–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞*"
            
            bot.reply_to(message, response, parse_mode='Markdown')
            return
        
        # –ü–†–û–í–ï–†–ö–ê - –Ω–∞—Å—Ç–æ—è—â–∏–π –ª–∏ —ç—Ç–æ –≤–æ–ø—Ä–æ—Å
        if not analyst.is_real_question(text):
            print(f"üéØ –ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω –∫–∞–∫ –≤–æ–ø—Ä–æ—Å: '{text}'")
            if chat_type == "private":
                response = f"üîÆ *–Ø, –•–æ—Ä–∞—Ä–Ω—ã–π –ò–º–ø–µ—Ä–∞—Ç–æ—Ä, –≤–Ω–µ–º–ª—é —Ç–≤–æ–∏–º —Å–ª–æ–≤–∞–º...*\n\n–ù–æ –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª —Å—É—Ç—å —Ç–≤–æ–µ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è. –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π, –æ —á–µ–º —Ç—ã —Ö–æ—á–µ—à—å —Å–ø—Ä–æ—Å–∏—Ç—å –í—ã—Å—à–∏–µ –°—Ñ–µ—Ä—ã?\n\n*–ü—Ä–∏–º–µ—Ä:* ¬´–ß—Ç–æ –º–µ–Ω—è –∂–¥–µ—Ç –≤ –ª—é–±–≤–∏?¬ª\n*–ò–ª–∏:* ¬´–ö–∞–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä–æ—é—Ç—Å—è –≤ —Ä–∞–±–æ—Ç–µ?¬ª"
            else:
                response = "üîÆ *–ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å –æ –ª—é–±–≤–∏, —Å—É–¥—å–±–µ –∏–ª–∏ –∏–∑–æ–±–∏–ª–∏–∏...*\n\n*–ò–ª–∏ –Ω–∞–ø–∏—à–∏:* ¬´–õ–∏—á–Ω–æ–µ [—Ç–≤–æ–π —Ç–∞–π–Ω—ã–π –≤–æ–ø—Ä–æ—Å]¬ª"
            
            bot.reply_to(message, response, parse_mode='Markdown')
            return
        
        # –ï–°–õ–ò –≠–¢–û –ù–ê–°–¢–û–Ø–©–ò–ô –í–û–ü–†–û–° - –¥–∞–µ–º –£–ú–ù–´–ô –†–ê–ó–ù–´–ô –∞–Ω–∞–ª–∏–∑
        print(f"üéØ –†–∞—Å–ø–æ–∑–Ω–∞–Ω –Ω–∞—Å—Ç–æ—è—â–∏–π –≤–æ–ø—Ä–æ—Å: '{text}'")
        bot.send_chat_action(message.chat.id, 'typing')
        time.sleep(2)
        
        verdict, analysis, strategy = analyst.generate_analysis(text, user_id, chat_type)
        
        if chat_type == "private":
            full_response = f"{verdict} {analysis}\n\n*üéØ –°–¢–†–ê–¢–ï–ì–ò–Ø –û–¢ –•–û–†–ê–†–ù–û–ì–û –ò–ú–ü–ï–†–ê–¢–û–†–ê:*\n{strategy}"
        else:
            full_response = f"{verdict} {analysis}\n\n*üéØ –°–¢–†–ê–¢–ï–ì–ò–Ø –û–¢ –•–û–†–ê–†–ù–û–ì–û –ò–ú–ü–ï–†–ê–¢–û–†–ê:*\n{strategy}\n\nüíå *–î–ª—è —Ç–∞–π–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ - –Ω–∞–ø–∏—à–∏ '–õ–∏—á–Ω–æ–µ [–≤–æ–ø—Ä–æ—Å]'*"
        
        bot.reply_to(message, full_response, parse_mode='Markdown')
        print(f"‚úÖ –£–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞: '{text}'")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        error_msg = "üåå *–ó–≤–µ–∑–¥—ã –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–∫—Ä—ã—Ç—ã —Ç—É—á–∞–º–∏... –ü–æ–ø—Ä–æ–±—É–π –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫–æ –º–Ω–µ —Å–Ω–æ–≤–∞.*"
        bot.reply_to(message, error_msg, parse_mode='Markdown')

print("üåå –•–û–†–ê–†–ù–´–ô –ò–ú–ü–ï–†–ê–¢–û–† –ó–ê–ü–£–©–ï–ù!")
print("ü§ñ –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ...")
print("üåê Flask —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 5000")

# –ó–ê–ü–£–°–ö –ë–û–¢–ê - –£–ü–†–û–©–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø –ë–ï–ó –ö–û–ù–§–õ–ò–ö–¢–û–í
if __name__ == "__main__":
    print("üîó –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ Telegram...")
    
    # –ü–†–û–°–¢–û–ô –ó–ê–ü–£–°–ö –ë–ï–ó –°–õ–û–ñ–ù–û–ô –õ–û–ì–ò–ö–ò
    try:
        print("üîÑ –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞...")
        bot.infinity_polling(timeout=60, long_polling_timeout=30)
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        print("üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥...")
        time.sleep(10)
