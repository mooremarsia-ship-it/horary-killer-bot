import telebot
import time
import random
import json
import os
from datetime import datetime, timedelta, timezone
from flask import Flask
import threading

# –°–æ–∑–¥–∞–µ–º Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è
app = Flask(__name__)

@app.route('/')
def health_check():
    return "üîÑ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –•–æ—Ä–∞—Ä–Ω—ã–π –ê–Ω–∞–ª–∏—Ç–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç!", 200

def run_flask():
    app.run(host='0.0.0.0', port=5000, debug=False)

flask_thread = threading.Thread(target=run_flask, daemon=True)
flask_thread.start()

BOT_TOKEN = "7166686748:AAFnyfjq5UsunijP_p8HQiYeKHh3qoAM5RA"
bot = telebot.TeleBot(BOT_TOKEN)

class UniversalAstroAnalyst:
    def __init__(self):
        self.experience = 0
        self.waiting_for_clarification = {}
        self.learning_data = {}
        self.load_learning_data()
    
    def load_learning_data(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è"""
        try:
            if os.path.exists('learning_data.json'):
                with open('learning_data.json', 'r', encoding='utf-8') as f:
                    self.learning_data = json.load(f)
        except:
            self.learning_data = {}
    
    def save_learning_data(self):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–±—É—á–µ–Ω–∏—è"""
        try:
            with open('learning_data.json', 'w', encoding='utf-8') as f:
                json.dump(self.learning_data, f, ensure_ascii=False, indent=2)
        except:
            pass
    
    def analyze_user_intent(self, question):
        """–£–ú–ù–û–ï —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        question_lower = question.lower()
        
        # –†–∞—Å–ø–æ–∑–Ω–∞–µ–º –ü–†–û–°–¢–´–ï –∏ –ë–´–¢–û–í–´–ï –≤–æ–ø—Ä–æ—Å—ã
        if any(word in question_lower for word in ['—Å–æ–ª–Ω—Ü–µ', '–ø–æ–≥–æ–¥–∞', '–¥–æ–∂–¥—å', '—Å–Ω–µ–≥']):
            return "WEATHER_QUESTION"
        
        # –†–∞—Å–ø–æ–∑–Ω–∞–µ–º –ì–õ–£–ë–û–ö–ò–ï –∏ –§–ò–õ–û–°–û–§–°–ö–ò–ï –≤–æ–ø—Ä–æ—Å—ã
        if any(word in question_lower for word in ['—Å–º—ã—Å–ª –∂–∏–∑–Ω–∏', '–ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ', '–º–∏—Å—Å–∏—è', '–¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å', '–≤—ã—Å—à–µ–µ —è']):
            return "SPIRITUAL_QUESTION"
        if any(word in question_lower for word in ['–±–ª–æ–∫', '–ø—Ä–æ–±–ª–µ–º–∞', '–ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ', '—Ç—É–ø–∏–∫', '–∑–∞—Å—Ç–æ–π']):
            return "BLOCK_QUESTION"
        if any(word in question_lower for word in ['—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ', '—ç–Ω–µ—Ä–≥–∏—è', '–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª', '—Å–∞–º–æ—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è']):
            return "CREATIVE_QUESTION"
        
        # –†–∞—Å–ø–æ–∑–Ω–∞–µ–º –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ –õ–°
        if any(word in question_lower for word in ['–ª–∏—á–Ω', '–ø—Ä–∏–≤–∞—Ç–Ω', '–∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü']):
            return "PRIVACY_REQUEST"
        
        # –û–±—ã—á–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
        if any(word in question_lower for word in ['–¥–µ–Ω—å–≥', '—Ñ–∏–Ω–∞–Ω—Å', '–ø—Ä–∏–¥—É—Ç', '–∑–∞—Ä–ø–ª–∞—Ç']):
            return "–§–ò–ù–ê–ù–°–´", "üí∞"
        elif any(word in question_lower for word in ['–ª—é–±–∏—Ç', '–æ—Ç–Ω–æ—à–µ–Ω', '–±—Ä–∞–∫', '—á—É–≤—Å—Ç–≤']):
            return "–û–¢–ù–û–®–ï–ù–ò–Ø", "üíñ" 
        elif any(word in question_lower for word in ['–∑–¥–æ—Ä–æ–≤', '–±–æ–ª–µ–∑', '–ª–µ—á–µ–Ω', '—Å–∞–º–æ—á—É–≤—Å—Ç–≤']):
            return "–ó–î–û–†–û–í–¨–ï", "üè•"
        elif any(word in question_lower for word in ['—Ä–∞–±–æ—Ç', '–∫–∞—Ä—å–µ—Ä', '–±–∏–∑–Ω–µ—Å', '–ø—Ä–æ–µ–∫—Ç']):
            return "–ö–ê–†–¨–ï–†–ê", "üöÄ"
        elif any(word in question_lower for word in ['–ø–æ–µ–∑–¥', '–ø—É—Ç–µ—à–µ—Å—Ç–≤', '–ø–µ—Ä–µ–µ–∑–¥']):
            return "–ü–£–¢–ï–®–ï–°–¢–í–ò–Ø", "‚úàÔ∏è"
        else:
            return "–£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô", "üîÆ"
    
    def generate_universal_analysis(self, question, user_id=None, chat_type="private"):
        """–£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –∞–Ω–∞–ª–∏–∑ —Å –ì–õ–£–ë–ò–ù–ù–û–ô –î–ò–ê–ì–ù–û–°–¢–ò–ö–û–ô"""
        
        intent = self.analyze_user_intent(question)
        
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
        if intent == "WEATHER_QUESTION":
            return self._get_weather_response()
        elif intent == "SPIRITUAL_QUESTION":
            return self._get_spiritual_analysis(question)
        elif intent == "BLOCK_QUESTION":
            return self._get_block_analysis(question)
        elif intent == "CREATIVE_QUESTION":
            return self._get_creative_analysis(question)
        elif intent == "PRIVACY_REQUEST":
            return self._get_privacy_response()
        
        # –û—Å–Ω–æ–≤–Ω–æ–π –∞–Ω–∞–ª–∏–∑
        moon_sign = get_random_zodiac()
        sun_sign = get_random_zodiac()
        rising_sign = get_random_zodiac()
        
        if len(question.strip()) < 5:
            return self._get_greeting_response(moon_sign, sun_sign, chat_type)
        
        if isinstance(intent, tuple):
            question_type, emoji = intent
        else:
            question_type, emoji = "–£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô", "üîÆ"
        
        # –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó
        return self._get_universal_reading(question, moon_sign, sun_sign, rising_sign, question_type)

    def _get_universal_reading(self, question, moon_sign, sun_sign, rising_sign, question_type):
        """–£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Å—Ñ–µ—Ä –∂–∏–∑–Ω–∏"""
        
        current_time = datetime.now(timezone.utc) + timedelta(hours=3)
        time_str = current_time.strftime('%H:%M, %d %B %Y')
        
        analysis_text = f"""
*üåå –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –ê–°–¢–†–û–õ–û–ì–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó*

*–í—Ä–µ–º—è:* {time_str}
*–í–æ–ø—Ä–æ—Å:* ¬´{question}¬ª

---

*üéØ –ö–ê–†–¢–ê –í–ê–®–ï–ì–û –í–û–ü–†–û–°–ê:*

‚Ä¢ *–í–∞—à–µ –í—ã—Å—à–µ–µ –Ø (–°–æ–ª–Ω—Ü–µ):* –≤ {sun_sign}
‚Ä¢ *–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–∏—Ä–æ–¥–∞ (–õ—É–Ω–∞):* –≤ {moon_sign}  
‚Ä¢ *–í–Ω–µ—à–Ω–µ–µ –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ (–í–æ—Å—Ö–æ–¥):* –≤ {rising_sign}

---

*üîç –ì–õ–£–ë–ò–ù–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –í–°–ï–• –°–§–ï–† –ñ–ò–ó–ù–ò:*
"""
        
        # –ê–ù–ê–õ–ò–ó –í–°–ï–• –ö–õ–Æ–ß–ï–í–´–• –°–§–ï–†
        analysis_text += self._analyze_life_spheres(moon_sign, sun_sign, rising_sign, question)
        
        # –í–´–Ø–í–õ–ï–ù–ò–ï –ë–õ–û–ö–û–í –ò –ü–†–û–ë–õ–ï–ú
        analysis_text += self._identify_blocks(moon_sign, sun_sign, rising_sign, question)
        
        # –î–£–•–û–í–ù–´–ï –ò–ù–°–ê–ô–¢–´
        analysis_text += self._get_spiritual_insights(moon_sign, sun_sign, rising_sign, question)
        
        analysis_text += f"\n---\n*üí´ –í–ï–†–î–ò–ö–¢ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:*\n\n{self._get_universal_verdict(moon_sign, sun_sign, rising_sign, question)}"
        
        verdict = self._get_universal_symbol(moon_sign, sun_sign)
        strategy = self._get_universal_strategy(moon_sign, sun_sign, rising_sign, question)
        
        # –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ø—Ä–æ—Å–∞
        self._learn_from_question(question, question_type)
        
        return verdict, analysis_text, strategy

    def _analyze_life_spheres(self, moon_sign, sun_sign, rising_sign, question):
        """–ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å—Ñ–µ—Ä –∂–∏–∑–Ω–∏"""
        analysis = "\n\n*üåà –ö–õ–Æ–ß–ï–í–´–ï –°–§–ï–†–´ –ñ–ò–ó–ù–ò:*\n"
        
        # 1. –õ–ò–ß–ù–´–ï –û–¢–ù–û–®–ï–ù–ò–Ø
        analysis += f"\n*üíñ –õ–ò–ß–ù–´–ï –û–¢–ù–û–®–ï–ù–ò–Ø:*\n"
        analysis += self._analyze_relationships(moon_sign, sun_sign, question)
        
        # 2. –§–ò–ù–ê–ù–°–´ –ò –ü–†–û–§–ï–°–°–ò–Ø
        analysis += f"\n*üí∞ –§–ò–ù–ê–ù–°–´ –ò –ü–†–û–§–ï–°–°–ò–Ø:*\n"
        analysis += self._analyze_finances(sun_sign, rising_sign, question)
        
        # 3. –ó–î–û–†–û–í–¨–ï –ò –≠–ù–ï–†–ì–ò–Ø
        analysis += f"\n*üè• –ó–î–û–†–û–í–¨–ï –ò –≠–ù–ï–†–ì–ò–Ø:*\n"
        analysis += self._analyze_health(moon_sign, sun_sign, question)
        
        # 4. –¢–í–û–†–ß–ï–°–¢–í–û –ò –°–ê–ú–û–†–ï–ê–õ–ò–ó–ê–¶–ò–Ø
        analysis += f"\n*üé® –¢–í–û–†–ß–ï–°–¢–í–û –ò –°–ê–ú–û–†–ï–ê–õ–ò–ó–ê–¶–ò–Ø:*\n"
        analysis += self._analyze_creativity(sun_sign, moon_sign, question)
        
        # 5. –î–£–•–û–í–ù–û–ï –†–ê–ó–í–ò–¢–ò–ï
        analysis += f"\n*üåå –î–£–•–û–í–ù–û–ï –†–ê–ó–í–ò–¢–ò–ï:*\n"
        analysis += self._analyze_spirituality(rising_sign, sun_sign, question)
        
        return analysis

    def _analyze_relationships(self, moon_sign, sun_sign, question):
        """–ì–ª—É–±–∏–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Ç–Ω–æ—à–µ–Ω–∏–π"""
        analysis = ""
        
        # –ê–Ω–∞–ª–∏–∑ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
        if moon_sign in ['–†–∞–∫', '–†—ã–±—ã', '–°–∫–æ—Ä–ø–∏–æ–Ω']:
            analysis += "‚Ä¢ *–ì–ª—É–±–æ–∫–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏* - –≤—ã –∏—â–µ—Ç–µ –¥—É—à–Ω—É—é —Å–≤—è–∑—å\n"
        elif moon_sign in ['–ë–ª–∏–∑–Ω–µ—Ü—ã', '–í–æ–¥–æ–ª–µ–π', '–í–µ—Å—ã']:
            analysis += "‚Ä¢ *–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Å–≤–æ–±–æ–¥–µ –∏ –æ–±—â–µ–Ω–∏–∏* - –≤–∞–∂–Ω—ã –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∏\n"
        else:
            analysis += "‚Ä¢ *–°—Ç–∞–±–∏–ª—å–Ω—ã–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã* - –≤—ã —Ü–µ–Ω–∏—Ç–µ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å\n"
        
        # –ê–Ω–∞–ª–∏–∑ –ª—é–±–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
        if sun_sign in ['–õ–µ–≤', '–û–≤–µ–Ω', '–°—Ç—Ä–µ–ª–µ—Ü']:
            analysis += "‚Ä¢ *–ê–∫—Ç–∏–≤–Ω–∞—è –ª—é–±–æ–≤–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è* - –≤—ã –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç–µ —è—Ä–∫–∏—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤\n"
        elif sun_sign in ['–¢–µ–ª–µ—Ü', '–î–µ–≤–∞', '–ö–æ–∑–µ—Ä–æ–≥']:
            analysis += "‚Ä¢ *–ü—Ä–∞–∫—Ç–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º* - –≤—ã –∏—â–µ—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å\n"
        else:
            analysis += "‚Ä¢ *–ì–∞—Ä–º–æ–Ω–∏—á–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è* - –≤—ã —É–º–µ–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å –±–∞–ª–∞–Ω—Å\n"
        
        # –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å–∞–π—Ç—ã
        if '–ª—é–±–∏—Ç' in question.lower() and '–º–∏—Ö–∞–∏–ª' in question.lower():
            analysis += "‚Ä¢ *üí° –ò–ù–°–ê–ô–¢:* –í–æ–∑–º–æ–∂–Ω–æ, –≤–∞–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è —Å –ú–∏—Ö–∞–∏–ª–∞ –Ω–∞ —Å–µ–±—è - –≤–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è —Å–µ–π—á–∞—Å –≤–∞–∂–Ω–µ–µ\n"
        
        return analysis

    def _analyze_finances(self, sun_sign, rising_sign, question):
        """–ì–ª—É–±–∏–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤"""
        analysis = ""
        
        if sun_sign in ['–¢–µ–ª–µ—Ü', '–ö–æ–∑–µ—Ä–æ–≥', '–î–µ–≤–∞']:
            analysis += "‚Ä¢ *–ü—Ä–∞–∫—Ç–∏—á–Ω—ã–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥* - –≤—ã —É–º–µ–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–µ—Å—É—Ä—Å–∞–º–∏\n"
        elif sun_sign in ['–õ–µ–≤', '–°—Ç—Ä–µ–ª–µ—Ü', '–û–≤–µ–Ω']:
            analysis += "‚Ä¢ *–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∞—è –∂–∏–ª–∫–∞* - –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ –¥–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏\n"
        else:
            analysis += "‚Ä¢ *–ì–∏–±–∫–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –¥–µ–Ω—å–≥–∞–º* - –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è\n"
        
        if rising_sign in ['–°–∫–æ—Ä–ø–∏–æ–Ω', '–†—ã–±—ã', '–†–∞–∫']:
            analysis += "‚Ä¢ *–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏* - –¥–æ–≤–µ—Ä—è–π—Ç–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –ø–æ–¥—Å–∫–∞–∑–∫–∞–º\n"
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–º–µ–Ω–µ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        if '—Ä–∞–±–æ—Ç' in question.lower() and any(word in question.lower() for word in ['—Å–º–µ–Ω–∏—Ç—å', '—É—Å—Ç–∞–ª', '–Ω–∞–¥–æ–µ–ª']):
            analysis += "‚Ä¢ *üí° –ò–ù–°–ê–ô–¢:* –í–æ–∑–º–æ–∂–Ω–æ, –≤–∞–º –Ω—É–∂–Ω–æ –∑–∞–Ω—è—Ç—å—Å—è —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ–º - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –∏—â–µ—Ç –≤—ã—Ö–æ–¥–∞\n"
        
        return analysis

    def _analyze_health(self, moon_sign, sun_sign, question):
        """–ì–ª—É–±–∏–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–¥–æ—Ä–æ–≤—å—è"""
        analysis = ""
        
        if moon_sign in ['–†–∞–∫', '–†—ã–±—ã']:
            analysis += "‚Ä¢ *–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏—è* - –≤–∞–∂–Ω–æ –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ–± —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏\n"
        elif moon_sign in ['–û–≤–µ–Ω', '–°—Ç—Ä–µ–ª–µ—Ü']:
            analysis += "‚Ä¢ *–°–∏–ª—å–Ω–∞—è –∂–∏–∑–Ω–µ–Ω–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è* - –Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏\n"
        else:
            analysis += "‚Ä¢ *–£—Å—Ç–æ–π—á–∏–≤–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ* - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –±–∞–ª–∞–Ω—Å\n"
        
        if sun_sign in ['–õ–µ–≤', '–û–≤–µ–Ω']:
            analysis += "‚Ä¢ *–í—ã—Å–æ–∫–∏–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ç–æ–Ω—É—Å* - –Ω–æ –±–µ—Ä–µ–≥–∏—Ç–µ —Å–µ—Ä–¥—Ü–µ –æ—Ç —Å—Ç—Ä–µ—Å—Å–æ–≤\n"
        
        return analysis

    def _analyze_creativity(self, sun_sign, moon_sign, question):
        """–ê–Ω–∞–ª–∏–∑ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞"""
        analysis = ""
        
        if sun_sign in ['–õ–µ–≤', '–ë–ª–∏–∑–Ω–µ—Ü—ã', '–í–æ–¥–æ–ª–µ–π']:
            analysis += "‚Ä¢ *–°–∏–ª—å–Ω—ã–π —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–æ–∫* - –≤—ã —Ä–æ–∂–¥–µ–Ω—ã —Ç–≤–æ—Ä–∏—Ç—å\n"
        elif moon_sign in ['–†–∞–∫', '–†—ã–±—ã', '–°–∫–æ—Ä–ø–∏–æ–Ω']:
            analysis += "‚Ä¢ *–ì–ª—É–±–æ–∫–∞—è –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞—è —Ç–≤–æ—Ä—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è* - –¥–æ–≤–µ—Ä—è–π—Ç–µ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—é\n"
        else:
            analysis += "‚Ä¢ *–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ* - –≤—ã –≤–æ–ø–ª–æ—â–∞–µ—Ç–µ –∏–¥–µ–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å\n"
        
        # –í—ã—è–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–π —ç–Ω–µ—Ä–≥–∏–∏
        if any(word in question.lower() for word in ['—Ç—É–ø–∏–∫', '–Ω–µ—Ç –∏–¥–µ–π', '–∑–∞—Å—Ç–æ–π']):
            analysis += "‚Ä¢ *üí° –ò–ù–°–ê–ô–¢:* –í–∞—à–∞ —Ç–≤–æ—Ä—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ - –≤–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –¥—É—Ö–æ–≤–Ω—ã–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º\n"
        
        return analysis

    def _analyze_spirituality(self, rising_sign, sun_sign, question):
        """–ê–Ω–∞–ª–∏–∑ –¥—É—Ö–æ–≤–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è"""
        analysis = ""
        
        if rising_sign in ['–†—ã–±—ã', '–°–∫–æ—Ä–ø–∏–æ–Ω', '–†–∞–∫']:
            analysis += "‚Ä¢ *–ì–ª—É–±–æ–∫–æ–µ –¥—É—Ö–æ–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ* - –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Ç–æ–Ω–∫–∏–µ –º–∏—Ä—ã\n"
        elif sun_sign in ['–°—Ç—Ä–µ–ª–µ—Ü', '–í–æ–¥–æ–ª–µ–π']:
            analysis += "‚Ä¢ *–§–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π —Å–∫–ª–∞–¥ —É–º–∞* - –≤—ã –∏—â–µ—Ç–µ –≤—ã—Å—à–∏–π —Å–º—ã—Å–ª\n"
        else:
            analysis += "‚Ä¢ *–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å* - –≤—ã –≤–æ–ø–ª–æ—â–∞–µ—Ç–µ –º—É–¥—Ä–æ—Å—Ç—å –≤ –∂–∏–∑–Ω–∏\n"
        
        if '—Å–º—ã—Å–ª' in question.lower() or '–ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ' in question.lower():
            analysis += "‚Ä¢ *üí° –ò–ù–°–ê–ô–¢:* –°–º—ã—Å–ª –∂–∏–∑–Ω–∏ - –ø–æ–∑–Ω–∞—Ç—å —Å–≤–æ–µ –í—ã—Å—à–µ–µ –Ø –∏ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –í–´ - –¢–í–û–†–ï–¶ —Å–≤–æ–µ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏\n"
        
        return analysis

    def _identify_blocks(self, moon_sign, sun_sign, rising_sign, question):
        """–í—ã—è–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏—Ö –±–ª–æ–∫–æ–≤"""
        analysis = "\n\n*üöß –í–´–Ø–í–õ–ï–ù–ù–´–ï –ë–õ–û–ö–ò –ò –ü–†–ï–ü–Ø–¢–°–¢–í–ò–Ø:*\n"
        
        blocks = []
        
        # –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏
        if moon_sign in ['–ö–æ–∑–µ—Ä–æ–≥', '–î–µ–≤–∞']:
            blocks.append("‚Ä¢ *–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–¥–µ—Ä–∂–∞–Ω–Ω–æ—Å—Ç—å* - –≤–æ–∑–º–æ–∂–Ω–æ, –≤—ã –±–ª–æ–∫–∏—Ä—É–µ—Ç–µ —á—É–≤—Å—Ç–≤–∞")
        elif moon_sign in ['–°–∫–æ—Ä–ø–∏–æ–Ω']:
            blocks.append("‚Ä¢ *–ì–ª—É–±–æ–∫–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∑–∞—â–∏—Ç—ã* - –º–æ–∂–µ—Ç –º–µ—à–∞—Ç—å –±–ª–∏–∑–æ—Å—Ç–∏")
        
        # –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –±–ª–æ–∫–∏
        if sun_sign in ['–†—ã–±—ã', '–†–∞–∫']:
            blocks.append("‚Ä¢ *–ù–µ—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö* - –º–µ—à–∞–µ—Ç –ø—Ä–æ—è–≤–ª—è—Ç—å –∏–∑–æ–±–∏–ª–∏–µ")
        
        # –¢–≤–æ—Ä—á–µ—Å–∫–∏–µ –±–ª–æ–∫–∏
        if any(word in question.lower() for word in ['–Ω–µ –º–æ–≥—É', '–Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è', '–Ω–µ –≤—ã—Ö–æ–¥–∏—Ç']):
            blocks.append("‚Ä¢ *–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –±–ª–æ–∫* - —ç–Ω–µ—Ä–≥–∏—è –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –≤—ã—Ö–æ–¥–∞")
        
        # –î—É—Ö–æ–≤–Ω—ã–µ –±–ª–æ–∫–∏
        if rising_sign in ['–¢–µ–ª–µ—Ü', '–ö–æ–∑–µ—Ä–æ–≥']:
            blocks.append("‚Ä¢ *–ü—Ä–∏–≤—è–∑–∫–∞ –∫ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–º—É* - –º–æ–∂–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –¥—É—Ö–æ–≤–Ω—ã–π —Ä–æ—Å—Ç")
        
        if blocks:
            analysis += "\n".join(blocks)
        else:
            analysis += "‚Ä¢ *–ó–Ω–∞—á–∏–º—ã—Ö –±–ª–æ–∫–æ–≤ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ* - —ç–Ω–µ—Ä–≥–∏—è —Ç–µ—á–µ—Ç —Å–≤–æ–±–æ–¥–Ω–æ"
        
        return analysis

    def _get_spiritual_insights(self, moon_sign, sun_sign, rising_sign, question):
        """–î—É—Ö–æ–≤–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã –∏ –æ—Ç–∫—Ä–æ–≤–µ–Ω–∏—è"""
        analysis = "\n\n*üå† –î–£–•–û–í–ù–´–ï –ò–ù–°–ê–ô–¢–´ –î–õ–Ø –í–ê–°:*\n"
        
        insights = []
        
        # –ò–Ω—Å–∞–π—Ç—ã –ø–æ –∑–Ω–∞–∫–∞–º
        if sun_sign == '–õ–µ–≤':
            insights.append("‚Ä¢ *–í–∞—à–∞ –º–∏—Å—Å–∏—è:* –°–∏—è—Ç—å –∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö —Å–≤–æ–∏–º –ø—Ä–∏–º–µ—Ä–æ–º")
        elif sun_sign == '–†—ã–±—ã':
            insights.append("‚Ä¢ *–í–∞—à–∞ –º–∏—Å—Å–∏—è:* –ò—Å—Ü–µ–ª—è—Ç—å –º–∏—Ä —á–µ—Ä–µ–∑ —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ –∏ –ª—é–±–æ–≤—å")
        elif sun_sign == '–í–æ–¥–æ–ª–µ–π':
            insights.append("‚Ä¢ *–í–∞—à–∞ –º–∏—Å—Å–∏—è:* –ü—Ä–∏–≤–Ω–æ—Å–∏—Ç—å –≤ –º–∏—Ä –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏ –∏ –Ω–æ–≤—ã–µ –∏–¥–µ–∏")
        
        # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã
        insights.append("‚Ä¢ *–ü–æ–º–Ω–∏—Ç–µ:* –í—ã - –Ω–µ —á–µ–ª–æ–≤–µ–∫, –∏–º–µ—é—â–∏–π –¥—É—Ö–æ–≤–Ω—ã–π –æ–ø—ã—Ç, –∞ –¥—É—Ö, –∏–º–µ—é—â–∏–π —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π –æ–ø—ã—Ç")
        insights.append("‚Ä¢ *–í–∞—à–µ –í—ã—Å—à–µ–µ –Ø* –≤—Å–µ–≥–¥–∞ –∑–Ω–∞–µ—Ç –æ—Ç–≤–µ—Ç - –¥–æ–≤–µ—Ä—è–π—Ç–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –≥–æ–ª–æ—Å—É")
        
        if '–º–∏—Ö–∞–∏–ª' in question.lower():
            insights.append("‚Ä¢ *üíé –ì–õ–£–ë–û–ö–ò–ô –ò–ù–°–ê–ô–¢:* –í–æ–∑–º–æ–∂–Ω–æ, –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –ú–∏—Ö–∞–∏–ª–æ–º - —ç—Ç–æ –∑–µ—Ä–∫–∞–ª–æ, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–µ–µ –≤–∞–º —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –∏—Å—Ü–µ–ª–∏—Ç—å –≤ —Å–µ–±–µ")
        
        analysis += "\n".join(insights)
        return analysis

    def _get_universal_verdict(self, moon_sign, sun_sign, rising_sign, question):
        """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –≤–µ—Ä–¥–∏–∫—Ç"""
        
        verdict = f"*üåü –û–ë–©–ò–ô –í–ï–†–î–ò–ö–¢:*\n\n"
        
        # –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ —ç–Ω–µ—Ä–≥–∏–∏
        energy_level = self._calculate_energy_level(moon_sign, sun_sign)
        
        if energy_level >= 8:
            verdict += "–í–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è –Ω–∞ –ü–ò–ö–ï! –°–µ–π—á–∞—Å –∏–¥–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è:\n‚Ä¢ –°–º–µ–ª—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ –Ω–∞—á–∏–Ω–∞–Ω–∏–π\n‚Ä¢ –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–º–±–∏—Ü–∏–æ–∑–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤\n‚Ä¢ –ü—Ä–æ—è–≤–ª–µ–Ω–∏—è –ª–∏–¥–µ—Ä—Å–∫–∏—Ö –∫–∞—á–µ—Å—Ç–≤\n\n*–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –º–æ—â–Ω—ã–π –ø–æ—Ç–æ–∫!*"
        elif energy_level >= 6:
            verdict += "–≠–Ω–µ—Ä–≥–∏—è –°–¢–ê–ë–ò–õ–¨–ù–ê –∏ –≥–∞—Ä–º–æ–Ω–∏—á–Ω–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:\n‚Ä¢ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∫ —Ü–µ–ª—è–º\n‚Ä¢ –£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ–≥–æ\n‚Ä¢ –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏–µ–º –∏ –æ—Ç–¥—ã—Ö–æ–º\n\n*–í—ã –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø—É—Ç–∏!*"
        else:
            verdict += "–≠–Ω–µ—Ä–≥–∏—è —Ç—Ä–µ–±—É–µ—Ç –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø. –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Ç–µ—Å—å –Ω–∞:\n‚Ä¢ –°–∞–º–æ–ø–æ–∑–Ω–∞–Ω–∏–∏ –∏ –æ—Ç–¥—ã—Ö–µ\n‚Ä¢ –ò—Å—Ü–µ–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ä—ã—Ö —Ä–∞–Ω\n‚Ä¢ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–∏ —Å–∏–ª –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞\n\n*–≠—Ç–æ –≤—Ä–µ–º—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ä–∞–±–æ—Ç—ã!*"
        
        # –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        if '–º–∏—Ö–∞–∏–ª' in question.lower():
            verdict += "\n\n*üíñ –û–¢–ù–û–®–ï–ù–ò–Ø –° –ú–ò–•–ê–ò–õ–û–ú:*\n–≠—Ç–∞ —Å–≤—è–∑—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–º –≤–∞–∂–Ω—ã–µ —É—Ä–æ–∫–∏ —Å–∞–º–æ–ª—é–±–∏—è. –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ñ–æ–∫—É—Å –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ."
        
        if any(word in question.lower() for word in ['–¥–µ–Ω—å–≥–∏', '—Ñ–∏–Ω–∞–Ω—Å—ã']):
            verdict += "\n\n*üí∞ –§–ò–ù–ê–ù–°–û–í–´–ô –ê–°–ü–ï–ö–¢:*\n–ò–∑–æ–±–∏–ª–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –æ—â—É—â–µ–Ω–∏—è —Ü–µ–Ω–Ω–æ—Å—Ç–∏. –ò—Å—Ü–µ–ª–∏—Ç–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –¥–µ–Ω—å–≥–∞–º–∏ —á–µ—Ä–µ–∑ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ."
        
        return verdict

    def _calculate_energy_level(self, moon_sign, sun_sign):
        """–†–∞—Å—á–µ—Ç —É—Ä–æ–≤–Ω—è —ç–Ω–µ—Ä–≥–∏–∏"""
        energy_scores = {
            '–û–≤–µ–Ω': 9, '–õ–µ–≤': 9, '–°—Ç—Ä–µ–ª–µ—Ü': 8,
            '–¢–µ–ª–µ—Ü': 6, '–î–µ–≤–∞': 5, '–ö–æ–∑–µ—Ä–æ–≥': 7,
            '–ë–ª–∏–∑–Ω–µ—Ü—ã': 7, '–í–µ—Å—ã': 6, '–í–æ–¥–æ–ª–µ–π': 7,
            '–†–∞–∫': 5, '–°–∫–æ—Ä–ø–∏–æ–Ω': 8, '–†—ã–±—ã': 6
        }
        
        moon_energy = energy_scores.get(moon_sign, 5)
        sun_energy = energy_scores.get(sun_sign, 5)
        
        return (moon_energy + sun_energy) // 2

    def _get_universal_symbol(self, moon_sign, sun_sign):
        """–°–∏–º–≤–æ–ª –≤–µ—Ä–¥–∏–∫—Ç–∞"""
        energy_level = self._calculate_energy_level(moon_sign, sun_sign)
        
        if energy_level >= 8:
            return "üöÄ"
        elif energy_level >= 6:
            return "üí´"
        else:
            return "üå±"

    def _get_universal_strategy(self, moon_sign, sun_sign, rising_sign, question):
        """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è"""
        
        strategies = []
        
        # –ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
        if sun_sign in ['–û–≤–µ–Ω', '–õ–µ–≤', '–°—Ç—Ä–µ–ª–µ—Ü']:
            strategies.append("‚Ä¢ *–î–µ–π—Å—Ç–≤—É–π—Ç–µ —Å–º–µ–ª–æ* - –≤–∞—à–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç —É—Å–ø–µ—Ö")
        elif sun_sign in ['–¢–µ–ª–µ—Ü', '–î–µ–≤–∞', '–ö–æ–∑–µ—Ä–æ–≥']:
            strategies.append("‚Ä¢ *–°—Ç—Ä–æ–π—Ç–µ –ø–ª–∞–Ω—ã* - —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ü–µ–ª–∏")
        else:
            strategies.append("‚Ä¢ *–î–æ–≤–µ—Ä—è–π—Ç–µ –∏–Ω—Ç—É–∏—Ü–∏–∏* - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –≥–æ–ª–æ—Å –∑–Ω–∞–µ—Ç –ø—É—Ç—å")
        
        # –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
        if '–æ—Ç–Ω–æ—à–µ–Ω' in question.lower():
            strategies.append("‚Ä¢ *–í –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö:* –§–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —Å–∞–º–æ–ª—é–±–∏–∏ - —Ç–æ–≥–¥–∞ –∏ –ø–∞—Ä—Ç–Ω–µ—Ä –ø—Ä–æ—è–≤–∏—Ç –ª—é–±–æ–≤—å")
        
        if '—Ñ–∏–Ω–∞–Ω—Å' in question.lower():
            strategies.append("‚Ä¢ *–í —Ñ–∏–Ω–∞–Ω—Å–∞—Ö:* –ò—â–∏—Ç–µ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–æ—Å–∏—Ç —Ä–∞–¥–æ—Å—Ç—å - —Ç–æ–≥–¥–∞ –¥–µ–Ω—å–≥–∏ –ø—Ä–∏–¥—É—Ç –ª–µ–≥–∫–æ")
        
        if '–∑–¥–æ—Ä–æ–≤' in question.lower():
            strategies.append("‚Ä¢ *–î–ª—è –∑–¥–æ—Ä–æ–≤—å—è:* –ò—Å—Ü–µ–ª—è–π—Ç–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã - —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ —É–ª—É—á—à–∏—Ç—Å—è")
        
        # –î—É—Ö–æ–≤–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
        strategies.append("‚Ä¢ *–ì–ª–∞–≤–Ω–æ–µ:* –ü–æ–º–Ω–∏—Ç–µ - –í–´ –¢–í–û–†–ï–¶ —Å–≤–æ–µ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏. –ú–µ–Ω—è–π—Ç–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ - –∏–∑–º–µ–Ω–∏—Ç—Å—è –≤–Ω–µ—à–Ω–µ–µ")
        
        return "\n".join(strategies)

    def _learn_from_question(self, question, question_type):
        """–û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ø—Ä–æ—Å–æ–≤"""
        key_phrases = [
            '–º–∏—Ö–∞–∏–ª', '–ª—é–±–∏—Ç', '–æ—Ç–Ω–æ—à–µ–Ω–∏—è', '–¥–µ–Ω—å–≥–∏', '—Ä–∞–±–æ—Ç–∞', 
            '–∑–¥–æ—Ä–æ–≤—å–µ', '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ', '—Å–º—ã—Å–ª', '–ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ'
        ]
        
        for phrase in key_phrases:
            if phrase in question.lower():
                if phrase not in self.learning_data:
                    self.learning_data[phrase] = 0
                self.learning_data[phrase] += 1
        
        self.experience += 1
        self.save_learning_data()

    # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –≥–ª—É–±–æ–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
    def _get_spiritual_analysis(self, question):
        """–ê–Ω–∞–ª–∏–∑ –¥—É—Ö–æ–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤"""
        responses = [
            "üåå *–î–£–•–û–í–ù–´–ô –û–¢–í–ï–¢ –ù–ê –í–ê–® –í–û–ü–†–û–°:*\n\n"
            "*–°–º—ã—Å–ª –∂–∏–∑–Ω–∏ - –ø–æ–∑–Ω–∞—Ç—å —Å–≤–æ–µ –í—ã—Å—à–µ–µ –Ø!*\n\n"
            "‚Ä¢ *–í—ã - –Ω–µ —á–µ–ª–æ–≤–µ–∫, –∏–º–µ—é—â–∏–π –¥—É—Ö–æ–≤–Ω—ã–π –æ–ø—ã—Ç*\n"
            "‚Ä¢ *–í—ã - –¥—É—Ö, –∏–º–µ—é—â–∏–π —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π –æ–ø—ã—Ç*\n\n"
            "*–í–∞—à–∞ –º–∏—Å—Å–∏—è:*\n"
            "‚Ä¢ –ü–æ–∑–Ω–∞—Ç—å —Å–µ–±—è –∫–∞–∫ –¢–≤–æ—Ä—Ü–∞\n"
            "‚Ä¢ –û—Å–æ–∑–Ω–∞—Ç—å —Å–≤–æ—é –±–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—É—é –ø—Ä–∏—Ä–æ–¥—É\n"
            "‚Ä¢ –¢–≤–æ—Ä–∏—Ç—å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –ª—é–±–æ–≤—å\n\n"
            "*–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ - —è –ø–æ–∫–∞–∂—É –¥—É—Ö–æ–≤–Ω—ã–π —É—Ä–æ–∫ –≤ –Ω–µ–π!*",
            
            "üíé *–û–¢–í–ï–¢ –û –ü–†–ï–î–ù–ê–ó–ù–ê–ß–ï–ù–ò–ò:*\n\n"
            "*–í–∞—à–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ - –ë–´–¢–¨ –°–û–ë–û–ô –≤ –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ!*\n\n"
            "*–ö–∞–∫ —Ä–∞—Å–∫—Ä—ã—Ç—å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ:*\n"
            "‚Ä¢ –°–ª—É—à–∞–π—Ç–µ —Å–µ—Ä–¥—Ü–µ, –∞ –Ω–µ —É–º\n"
            "‚Ä¢ –ó–∞–Ω–∏–º–∞–π—Ç–µ—Å—å —Ç–µ–º, —á—Ç–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç —Ä–∞–¥–æ—Å—Ç—å\n"
            "‚Ä¢ –î–æ–≤–µ—Ä—è–π—Ç–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É\n\n"
            "*–í—ã —É–∂–µ –∑–Ω–∞–µ—Ç–µ –æ—Ç–≤–µ—Ç - –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏—Å–ª—É—à–∞–π—Ç–µ—Å—å –∫ —Ç–∏—à–∏–Ω–µ –≤–Ω—É—Ç—Ä–∏*"
        ]
        
        verdict = "üåå"
        analysis = random.choice(responses)
        strategy = "–ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –º–µ–¥–∏—Ç–∞—Ü–∏—é –∏ —Å–∞–º–æ–ø–æ–∑–Ω–∞–Ω–∏–µ"
        
        return verdict, analysis, strategy

    def _get_block_analysis(self, question):
        """–ê–Ω–∞–ª–∏–∑ –±–ª–æ–∫–æ–≤ –∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π"""
        responses = [
            "üöß *–ê–ù–ê–õ–ò–ó –≠–ù–ï–†–ì–ï–¢–ò–ß–ï–°–ö–ò–• –ë–õ–û–ö–û–í:*\n\n"
            "*–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –±–ª–æ–∫–∏:*\n\n"
            "‚Ä¢ *–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –±–ª–æ–∫* - –Ω–µ–∑–∞–ª–µ—á–µ–Ω–Ω—ã–µ –ø—Ä–æ—à–ª—ã–µ —Ä–∞–Ω—ã\n"
            "‚Ä¢ *–ú–µ–Ω—Ç–∞–ª—å–Ω—ã–π –±–ª–æ–∫* - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —É–±–µ–∂–¥–µ–Ω–∏—è\n"
            "‚Ä¢ *–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –±–ª–æ–∫* - –Ω–µ–≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è\n\n"
            "*–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–Ω—è—Ç–∏—é –±–ª–æ–∫–æ–≤:*\n"
            "‚Ä¢ –ü—Ä–∞–∫—Ç–∏–∫–∞ –ø—Ä–æ—â–µ–Ω–∏—è —Å–µ–±—è –∏ –¥—Ä—É–≥–∏—Ö\n"
            "‚Ä¢ –†–∞–±–æ—Ç–∞ —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ä–µ–±–µ–Ω–∫–æ–º\n"
            "‚Ä¢ –¢–≤–æ—Ä—á–µ—Å–∫–æ–µ —Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏–µ\n"
            "‚Ä¢ –≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏\n\n"
            "*–ë–ª–æ–∫–∏ - —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–æ—Å—Ç–∞!*",
            
            "üí´ *–ü–†–ï–û–î–û–õ–ï–ù–ò–ï –ü–†–ï–ü–Ø–¢–°–¢–í–ò–ô:*\n\n"
            "*–í–∞—à–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:*\n\n"
            "‚Ä¢ –ì–¥–µ –Ω—É–∂–Ω–æ —Ä–∞–∑–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞\n"
            "‚Ä¢ –ö–∞–∫–∏–µ —É—Ä–æ–∫–∏ –¥—É—à–∞ –≤—ã–±—Ä–∞–ª–∞ –¥–ª—è —Ä–æ—Å—Ç–∞\n"
            "‚Ä¢ –í –∫–∞–∫–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –¥–≤–∏–≥–∞—Ç—å—Å—è\n\n"
            "*–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –∫–∞–∫ —Ç—Ä–∞–º–ø–ª–∏–Ω!*"
        ]
        
        verdict = "üöß"
        analysis = random.choice(responses)
        strategy = "–§–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —Ä–µ—à–µ–Ω–∏–∏, –∞ –Ω–µ –Ω–∞ –ø—Ä–æ–±–ª–µ–º–µ"
        
        return verdict, analysis, strategy

    def _get_creative_analysis(self, question):
        """–ê–Ω–∞–ª–∏–∑ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞"""
        responses = [
            "üé® *–ê–ù–ê–õ–ò–ó –¢–í–û–†–ß–ï–°–ö–û–ì–û –ü–û–¢–ï–ù–¶–ò–ê–õ–ê:*\n\n"
            "*–í–∞—à —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–æ–∫:*\n\n"
            "‚Ä¢ *–°–∏–ª–∞ –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è:* –†–∞–∑–≤–∏—Ç–∞ —Ö–æ—Ä–æ—à–æ\n"
            "‚Ä¢ *–≠–Ω–µ—Ä–≥–∏—è –≤–æ–ø–ª–æ—â–µ–Ω–∏—è:* –¢—Ä–µ–±—É–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç–∏—è\n"
            "‚Ä¢ *–°–≤—è–∑—å —Å –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ–º:* –î–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–≥–¥–∞\n\n"
            "*–ö–∞–∫ —Ä–∞—Å–∫—Ä—ã—Ç—å —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ:*\n"
            "‚Ä¢ –ü—Ä–µ–∫—Ä–∞—Ç–∏—Ç–µ –∫—Ä–∏—Ç–∏–∫–æ–≤–∞—Ç—å —Å–µ–±—è\n"
            "‚Ä¢ –†–∞–∑—Ä–µ—à–∏—Ç–µ —Å–µ–±–µ —Ç–≤–æ—Ä–∏—Ç—å –ø–ª–æ—Ö–æ\n"
            "‚Ä¢ –°–ª—É—à–∞–π—Ç–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–µ–±–µ–Ω–∫–∞\n"
            "‚Ä¢ –ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –ø–æ—Ç–æ–∫–æ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è\n\n"
            "*–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ - —ç—Ç–æ –≤–∞—à–∞ –ø—Ä–∏—Ä–æ–¥–∞!*"
        ]
        
        verdict = "üé®"
        analysis = random.choice(responses)
        strategy = "–¢–≤–æ—Ä–∏—Ç–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, –¥–∞–∂–µ –ø–æ 5 –º–∏–Ω—É—Ç"
        
        return verdict, analysis, strategy

    def _get_weather_response(self):
        """–û—Ç–≤–µ—Ç –Ω–∞ –ø–æ–≥–æ–¥–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã"""
        response = "‚òÄÔ∏è *–û –ø–æ–≥–æ–¥–µ –ª—É—á—à–µ —Å–ø—Ä–æ—Å–∏—Ç–µ —É –º–µ—Ç–µ–æ—Ä–æ–ª–æ–≥–æ–≤!*\n\n*–Ø –∂–µ –º–æ–≥—É –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å:*\n‚Ä¢ –í–∞—à –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–ª–∏–º–∞—Ç –∏ —ç–º–æ—Ü–∏–∏\n‚Ä¢ –≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ—Ç–æ–∫–∏ –≤ –∂–∏–∑–Ω–∏\n‚Ä¢ –î—É—Ö–æ–≤–Ω—ã–µ —Å–µ–∑–æ–Ω—ã –≤–∞—à–µ–π –¥—É—à–∏\n\n*–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ —á–µ–º-—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω–æ–º!* üåü"
        
        verdict = "‚òÄÔ∏è"
        analysis = response
        strategy = "–°–ø—Ä–æ—Å–∏—Ç–µ –æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö, —Ñ–∏–Ω–∞–Ω—Å–∞—Ö –∏–ª–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏"
        
        return verdict, analysis, strategy

    def _get_privacy_response(self):
        """–û—Ç–≤–µ—Ç –æ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏"""
        response = "üîí *–ö–û–ù–§–ò–î–ï–ù–¶–ò–ê–õ–¨–ù–û–°–¢–¨ –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ê!*\n\n*–í–∞—à–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ–±—â–µ–Ω–∏—è:*\n‚Ä¢ üí¨ –ü—É–±–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å –∑–¥–µ—Å—å\n‚Ä¢ üîí –õ–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ '–õ–∏—á–Ω–æ–µ [–≤–æ–ø—Ä–æ—Å]'\n‚Ä¢ üíå –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –≤ –õ–°\n\n*–í–∞—à–∞ —Ç–∞–π–Ω–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!*"
        
        verdict = "üîí"
        analysis = response
        strategy = "–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±—â–µ–Ω–∏—è"
        
        return verdict, analysis, strategy

    def _get_greeting_response(self, moon_sign, sun_sign, chat_type):
        """–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ"""
        if chat_type == "private":
            response = f"üåå *–ü—Ä–∏–≤–µ—Ç! –Ø –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ê—Å—Ç—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ê–Ω–∞–ª–∏—Ç–∏–∫!*\n\n*–Ø –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –í–°–ï —Å—Ñ–µ—Ä—ã –∂–∏–∑–Ω–∏:*\n‚Ä¢ üíñ –û—Ç–Ω–æ—à–µ–Ω–∏—è –∏ –ª—é–±–æ–≤—å\n‚Ä¢ üí∞ –§–∏–Ω–∞–Ω—Å—ã –∏ –∫–∞—Ä—å–µ—Ä–∞\n‚Ä¢ üè• –ó–¥–æ—Ä–æ–≤—å–µ –∏ —ç–Ω–µ—Ä–≥–∏—è\n‚Ä¢ üé® –¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª\n‚Ä¢ üåå –î—É—Ö–æ–≤–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ\n\n*–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å - –ø–æ–ª—É—á—É –ì–õ–£–ë–û–ö–ò–ô –∞–Ω–∞–ª–∏–∑!*"
        else:
            response = "üåå *–ü—Ä–∏–≤–µ—Ç! –Ø –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ê–Ω–∞–ª–∏—Ç–∏–∫!*\n\nüí¨ *–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –∑–¥–µ—Å—å*\nüîí *–ò–ª–∏ '–õ–∏—á–Ω–æ–µ [–≤–æ–ø—Ä–æ—Å]' –¥–ª—è –õ–°*\nüíå *–ò–ª–∏ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è*\n\n*–ß—Ç–æ –≤—ã–±–µ—Ä–µ—Ç–µ?* ‚ú®"
        
        verdict = "üåå"
        analysis = response
        strategy = "–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –¥–ª—è –≥–ª—É–±–∏–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞"
        
        return verdict, analysis, strategy

# –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
def get_random_zodiac():
    signs = ['–û–≤–µ–Ω', '–¢–µ–ª–µ—Ü', '–ë–ª–∏–∑–Ω–µ—Ü—ã', '–†–∞–∫', '–õ–µ–≤', '–î–µ–≤–∞', '–í–µ—Å—ã', '–°–∫–æ—Ä–ø–∏–æ–Ω', '–°—Ç—Ä–µ–ª–µ—Ü', '–ö–æ–∑–µ—Ä–æ–≥', '–í–æ–¥–æ–ª–µ–π', '–†—ã–±—ã']
    return random.choice(signs)

def get_moscow_time():
    utc_time = datetime.now(timezone.utc)
    moscow_time = utc_time + timedelta(hours=3)
    return moscow_time.strftime('%H:%M, %d.%m.%Y')

# –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
analyst = UniversalAstroAnalyst()

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (–æ—Å—Ç–∞—é—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–º, –Ω–æ —Å –≤—ã–∑–æ–≤–æ–º analyst.generate_universal_analysis)

print("üîÑ –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –ê–°–¢–†–û–õ–û–ì–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–¢–ò–ö –∑–∞–ø—É—â–µ–Ω...")
