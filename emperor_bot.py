import telebot
import time
import random
from datetime import datetime, timedelta, timezone
from flask import Flask
import threading

print("üåå –ó–∞–ø—É—Å–∫–∞—é –£–º–Ω–æ–≥–æ –•–æ—Ä–∞—Ä–Ω–æ–≥–æ –ò–º–ø–µ—Ä–∞—Ç–æ—Ä–∞...")

app = Flask(__name__)
@app.route('/')
def health_check():
    return "üîÑ –£–º–Ω—ã–π –•–æ—Ä–∞—Ä–Ω—ã–π –ò–º–ø–µ—Ä–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç!", 200

def run_flask():
    app.run(host='0.0.0.0', port=5000, debug=False)

flask_thread = threading.Thread(target=run_flask, daemon=True)
flask_thread.start()

BOT_TOKEN = "7166686748:AAFnyfjq5UsunijP_p8HQiYeKHh3qoAM5RA"
bot = telebot.TeleBot(BOT_TOKEN)

class SmartEmperor:
    def __init__(self):
        print("üîÆ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é –£–º–Ω–æ–≥–æ –ò–º–ø–µ—Ä–∞—Ç–æ—Ä–∞...")
    
    def get_greeting(self):
        return "üåå *–Ø –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é —Ç–µ–±—è, –ò—Å–∫–∞—Ç–µ–ª—å!* –° –∫–∞–∫–∏–º –≤–æ–ø—Ä–æ—Å–æ–º —Ç—ã –ø—Ä–∏—à—ë–ª –∫–æ –º–Ω–µ —Å–µ–≥–æ–¥–Ω—è?"

    def analyze_question(self, question):
        """–ü–†–û–°–¢–û–ô –∞–Ω–∞–ª–∏–∑ - —á—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç?"""
        question_lower = question.lower()
        
        # –õ–Æ–ë–û–í–¨ - —Ç–æ–ª—å–∫–æ –ø—Ä–æ –ª—é–±–æ–≤—å!
        if any(word in question_lower for word in ['–ª—é–±–æ–≤', '–æ—Ç–Ω–æ—à–µ–Ω', '—á—É–≤—Å—Ç–≤–∞', '–≤—Å—Ç—Ä–µ—á', '–ø–∞—Ä–µ–Ω—å', '–º—É–∂—á–∏–Ω', '–∂–µ–Ω—â–∏–Ω', '–±—Ä–∞–∫', '–∑–∞–º—É–∂–µ—Å—Ç–≤']):
            if '–¥–æ –∫–æ–Ω—Ü–∞ –Ω–æ—è–±—Ä—è' in question_lower:
                return "LOVE_NOVEMBER"
            elif '–¥–æ –∫–æ–Ω—Ü–∞ –≥–æ–¥–∞' in question_lower:
                return "LOVE_YEAR_END" 
            else:
                return "LOVE_GENERAL"
        
        # –î–ï–ù–¨–ì–ò - —Ç–æ–ª—å–∫–æ –ø—Ä–æ –¥–µ–Ω—å–≥–∏!
        elif any(word in question_lower for word in ['–¥–µ–Ω—å–≥', '—Ñ–∏–Ω–∞–Ω—Å', '–¥–µ–Ω–µ–≥', '–∑–∞—Ä–∞–±–æ—Ç', '–¥–æ—Ö–æ–¥', '–±–æ–≥–∞—Ç—Å—Ç–≤']):
            if '–ø–µ—Ä–µ–µ–∑–¥' in question_lower:
                return "MONEY_TRAVEL"
            else:
                return "MONEY_GENERAL"
        
        # –ö–ê–†–¨–ï–†–ê - —Ç–æ–ª—å–∫–æ –ø—Ä–æ –∫–∞—Ä—å–µ—Ä—É!
        elif any(word in question_lower for word in ['—Ä–∞–±–æ—Ç', '–∫–∞—Ä—å–µ—Ä', '–ø—Ä–æ—Ñ–µ—Å—Å–∏', '–¥–æ–ª–∂–Ω–æ—Å—Ç']):
            return "CAREER"
        
        # –ó–î–û–†–û–í–¨–ï - —Ç–æ–ª—å–∫–æ –ø—Ä–æ –∑–¥–æ—Ä–æ–≤—å–µ!
        elif any(word in question_lower for word in ['–∑–¥–æ—Ä–æ–≤', '–±–æ–ª–µ–∑', '–ª–µ—á–µ–Ω', '–≤—Ä–∞—á']):
            return "HEALTH"
        
        # –û–ë–©–ò–ô –≤–æ–ø—Ä–æ—Å
        else:
            return "GENERAL"

    def generate_answer(self, question):
        """–î–ê–ï–¢ –¢–û–õ–¨–ö–û –¢–û, –û –ß–ï–ú –°–ü–†–û–°–ò–õ–ò!"""
        question_type = self.analyze_question(question)
        current_time = datetime.now(timezone.utc) + timedelta(hours=3)
        time_str = current_time.strftime('%H:%M, %d %B %Y')
        
        print(f"üéØ –¢–∏–ø –≤–æ–ø—Ä–æ—Å–∞: {question_type}")
        
        if question_type == "LOVE_NOVEMBER":
            return self._get_love_november_answer(question, time_str)
        elif question_type == "LOVE_YEAR_END":
            return self._get_love_year_end_answer(question, time_str)
        elif question_type == "LOVE_GENERAL":
            return self._get_love_general_answer(question, time_str)
        elif question_type == "MONEY_TRAVEL":
            return self._get_money_travel_answer(question, time_str)
        elif question_type == "MONEY_GENERAL":
            return self._get_money_general_answer(question, time_str)
        elif question_type == "CAREER":
            return self._get_career_answer(question, time_str)
        elif question_type == "HEALTH":
            return self._get_health_answer(question, time_str)
        else:
            return self._get_general_answer(question, time_str)

    def _get_love_november_answer(self, question, time_str):
        """–¢–û–õ–¨–ö–û –ø—Ä–æ –ª—é–±–æ–≤—å –¥–æ –∫–æ–Ω—Ü–∞ –Ω–æ—è–±—Ä—è!"""
        analysis = f"""
*üíñ –•–û–†–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó –õ–Æ–ë–í–ò –î–û –ö–û–ù–¶–ê –ù–û–Ø–ë–†–Ø*

*–í—Ä–µ–º—è:* {time_str}
*–í–æ–ø—Ä–æ—Å:* ¬´{question}¬ª

---

*üåô –ö–û–ù–ö–†–ï–¢–ù–´–ô –ü–†–û–ì–ù–û–ó –î–û –ö–û–ù–¶–ê –ù–û–Ø–ë–†–Ø:*

*–û–°–¢–ê–õ–û–°–¨ –ù–ï–°–ö–û–õ–¨–ö–û –ù–ï–î–ï–õ–¨ - –≤–æ—Ç —á—Ç–æ —Ç–µ–±—è –∂–¥–µ—Ç:*

‚ú® *–°–ï–ì–û–î–ù–Ø - 10 –ù–û–Ø–ë–†–Ø:*
‚Ä¢ –í–æ–∑–º–æ–∂–Ω—ã –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–∫–ª–æ–Ω–Ω–∏–∫–æ–≤
‚Ä¢ –®–∞–Ω—Å –≤—Å—Ç—Ä–µ—á–∏ —á–µ—Ä–µ–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –∏–ª–∏ –¥—Ä—É–∑–µ–π
‚Ä¢ –≠–Ω–µ—Ä–≥–∏—è –¥–ª—è —Ñ–ª–∏—Ä—Ç–∞ –∏ –ª–µ–≥–∫–æ–≥–æ –æ–±—â–µ–Ω–∏—è

‚ú® *11-20 –ù–û–Ø–ë–†–Ø:*
‚Ä¢ –ü–µ—Ä–∏–æ–¥ –≥–ª—É–±–æ–∫–∏—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ –æ —á—É–≤—Å—Ç–≤–∞—Ö
‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–Ω–∏—è –≤ –ª—é–±–≤–∏
‚Ä¢ –í–∞–∂–Ω—ã–µ –æ—Ç–∫—Ä–æ–≤–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö

‚ú® *21-30 –ù–û–Ø–ë–†–Ø:*
‚Ä¢ –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Å–≤–∏–¥–∞–Ω–∏–µ —Å –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–æ–π
‚Ä¢ –ù–æ–≤—ã–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö
‚Ä¢ –†–µ—à–µ–Ω–∏–µ –æ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π

---

*üí´ –í–ï–†–î–ò–ö–¢ –ò–ú–ü–ï–†–ê–¢–û–†–ê:*
*–î–æ –∫–æ–Ω—Ü–∞ –Ω–æ—è–±—Ä—è —Ç–µ–±—è –∂–¥—É—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –ª—é–±–≤–∏!* –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–µ—Ä–∏–æ–¥ 15-25 –Ω–æ—è–±—Ä—è.
"""
        
        strategy = """*üéØ –ß–¢–û –î–ï–õ–ê–¢–¨:*
‚Ä¢ –ë—É–¥—å –æ—Ç–∫—Ä—ã—Ç–∞ –Ω–æ–≤—ã–º –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞–º
‚Ä¢ –ù–µ –±–æ–π—Å—è –ø—Ä–æ—è–≤–ª—è—Ç—å –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É
‚Ä¢ –ü—Ä–∏—Å–ª—É—à–∏–≤–∞–π—Å—è –∫ –∏–Ω—Ç—É–∏—Ü–∏–∏ –≤ –≤—ã–±–æ—Ä–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
‚Ä¢ –ì–æ—Ç–æ–≤—å—Å—è –∫ –≤–∞–∂–Ω—ã–º —Ä–∞–∑–≥–æ–≤–æ—Ä–∞–º –æ —á—É–≤—Å—Ç–≤–∞—Ö"""

        return analysis, strategy

    def _get_love_year_end_answer(self, question, time_str):
        """–¢–û–õ–¨–ö–û –ø—Ä–æ –ª—é–±–æ–≤—å –¥–æ –∫–æ–Ω—Ü–∞ –≥–æ–¥–∞!"""
        analysis = f"""
*üíñ –•–û–†–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó –õ–Æ–ë–í–ò –î–û –ö–û–ù–¶–ê –ì–û–î–ê*

*–í—Ä–µ–º—è:* {time_str}
*–í–æ–ø—Ä–æ—Å:* ¬´{question}¬ª

---

*‚ùÑÔ∏è –ö–û–ù–ö–†–ï–¢–ù–´–ô –ü–†–û–ì–ù–û–ó –î–û –ö–û–ù–¶–ê 2025 –ì–û–î–ê:*

*–î–û –ù–û–í–û–ì–û –ì–û–î–ê –û–°–¢–ê–õ–û–°–¨ 6 –ù–ï–î–ï–õ–¨ - –≤–æ—Ç —Ç–≤–æ–∏ —à–∞–Ω—Å—ã:*

‚ú® *–ù–û–Ø–ë–†–¨:*
‚Ä¢ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–µ—Ä—å–µ–∑–Ω—ã–º –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º
‚Ä¢ –ò—Å—Ü–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ä–∞–Ω
‚Ä¢ –ù–æ–≤—ã–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ —Ä–∞–±–æ—Ç—É/—É—á–µ–±—É

‚ú® *–î–ï–ö–ê–ë–†–¨:*
‚Ä¢ –°—É–¥—å–±–æ–Ω–æ—Å–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞ –Ω–∞ –ø—Ä–∞–∑–¥–Ω–∏–∫–∞—Ö
‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç–ø—É—Å–∫–∞
‚Ä¢ –ì–ª—É–±–æ–∫–æ–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

‚ú® *–Ø–ù–í–ê–†–¨ 2026:*
‚Ä¢ –ù–∞—á–∞–ª–æ –Ω–æ–≤—ã—Ö —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π
‚Ä¢ –†–µ—à–µ–Ω–∏–µ –æ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–º –±—É–¥—É—â–µ–º
‚Ä¢ –°–µ–º–µ–π–Ω—ã–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã

---

*üí´ –í–ï–†–î–ò–ö–¢ –ò–ú–ü–ï–†–ê–¢–û–†–ê:*
*–î–æ –∫–æ–Ω—Ü–∞ –≥–æ–¥–∞ —É —Ç–µ–±—è –≤—ã—Å–æ–∫–∏–µ —à–∞–Ω—Å—ã –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –ª—é–±–æ–≤—å!* –û—Å–æ–±–µ–Ω–Ω–æ –≤ –ø—Ä–µ–¥–Ω–æ–≤–æ–≥–æ–¥–Ω–∏–π –ø–µ—Ä–∏–æ–¥.
"""
        
        strategy = """*üéØ –ß–¢–û –î–ï–õ–ê–¢–¨:*
‚Ä¢ –ü–æ—Å–µ—â–∞–π –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
‚Ä¢ –ë—É–¥—å –æ—Ç–∫—Ä—ã—Ç–∞ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞–º
‚Ä¢ –†–∞–±–æ—Ç–∞–π –Ω–∞–¥ —Å–∞–º–æ–æ—Ü–µ–Ω–∫–æ–π
‚Ä¢ –ì–æ—Ç–æ–≤—å—Å—è –∫ —Å–µ—Ä—å–µ–∑–Ω—ã–º –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º"""

        return analysis, strategy

    def _get_love_general_answer(self, question, time_str):
        """–¢–û–õ–¨–ö–û –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª—é–±–≤–∏!"""
        analysis = f"""
*üíñ –•–û–†–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó –¢–í–û–ï–ô –õ–Æ–ë–û–í–ù–û–ô –≠–ù–ï–†–ì–ï–¢–ò–ö–ò*

*–í—Ä–µ–º—è:* {time_str}
*–í–æ–ø—Ä–æ—Å:* ¬´{question}¬ª

---

*üîÆ –¢–í–û–ô –¢–ï–ö–£–©–ò–ô –ü–û–¢–ï–ù–¶–ò–ê–õ –î–õ–Ø –õ–Æ–ë–í–ò:*

‚ú® *–≠–ù–ï–†–ì–ï–¢–ò–ö–ê:* 
–¢—ã —Å–µ–π—á–∞—Å –æ—á–µ–Ω—å –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–≥–æ –ø–æ–ª–∞. –¢–≤–æ—è –∞—É—Ä–∞ –∏–∑–ª—É—á–∞–µ—Ç —Ç–µ–ø–ª–æ –∏ –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å.

‚ú® *–í–ï–†–û–Ø–¢–ù–´–ï –°–û–ë–´–¢–ò–Ø:*
‚Ä¢ –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º –≤ –±–ª–∏–∂–∞–π—à–∏–µ 2 –Ω–µ–¥–µ–ª–∏
‚Ä¢ –£–≥–ª—É–±–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π
‚Ä¢ –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ

‚ú® *–ü–†–ï–ü–Ø–¢–°–¢–í–ò–Ø:*
–í–æ–∑–º–æ–∂–Ω—ã –Ω–µ–±–æ–ª—å—à–∏–µ –Ω–µ–¥–æ–ø–æ–Ω–∏–º–∞–Ω–∏—è, –Ω–æ –æ–Ω–∏ –±—ã—Å—Ç—Ä–æ —Ä–µ—à–∞—Ç—Å—è.
"""
        
        strategy = """*üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø –õ–Æ–ë–í–ò:*
‚Ä¢ –ù–æ—Å–∏ –±–æ–ª—å—à–µ –∫—Ä–∞—Å–Ω–æ–≥–æ –∏ —Ä–æ–∑–æ–≤–æ–≥–æ
‚Ä¢ –ß–∞—â–µ –±—ã–≤–∞–π –≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
‚Ä¢ –†–∞–±–æ—Ç–∞–π –Ω–∞–¥ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–µ–π
‚Ä¢ –í–µ—Ä—å –≤ —Å–≤–æ—é –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å"""

        return analysis, strategy

    def _get_money_travel_answer(self, question, time_str):
        """–¢–û–õ–¨–ö–û –ø—Ä–æ –¥–µ–Ω—å–≥–∏ –¥–ª—è –ø–µ—Ä–µ–µ–∑–¥–∞!"""
        analysis = f"""
*üí∞ –•–û–†–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó –§–ò–ù–ê–ù–°–û–í –î–õ–Ø –ü–ï–†–ï–ï–ó–î–ê*

*–í—Ä–µ–º—è:* {time_str}
*–í–æ–ø—Ä–æ—Å:* ¬´{question}¬ª

---

*üíé –ö–û–ù–ö–†–ï–¢–ù–´–ô –§–ò–ù–ê–ù–°–û–í–´–ô –ü–†–û–ì–ù–û–ó:*

‚ú® *–ò–°–¢–û–ß–ù–ò–ö–ò –î–ï–ù–ï–ì:*
‚Ä¢ –í–æ–∑–≤—Ä–∞—Ç —Å—Ç–∞—Ä—ã—Ö –¥–æ–ª–≥–æ–≤ (70% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)
‚Ä¢ –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –ø—Ä–µ–º–∏—è –∏–ª–∏ –±–æ–Ω—É—Å
‚Ä¢ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ –æ—Ç —Ö–æ–±–±–∏

‚ú® *–°–£–ú–ú–ê:* 
–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ–µ–∑–¥–∞

‚ú® *–°–†–û–ö–ò:*
–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –±–ª–∏–∂–∞–π—à–∏–µ 3 –Ω–µ–¥–µ–ª–∏
"""
        
        strategy = """*üéØ –§–ò–ù–ê–ù–°–û–í–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø:*
‚Ä¢ –ê–∫—Ç–∏–≤–Ω–æ —Ç—Ä–µ–±—É–π –≤–æ–∑–≤—Ä–∞—Ç–∞ –¥–æ–ª–≥–æ–≤
‚Ä¢ –ü—Ä–æ—è–≤–∏ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É –Ω–∞ —Ä–∞–±–æ—Ç–µ
‚Ä¢ –†–∞—Å—Å–º–æ—Ç—Ä–∏ –ø–æ–¥—Ä–∞–±–æ—Ç–∫—É
‚Ä¢ –ù–∞—á–Ω–∏ —Å–æ–±–∏—Ä–∞—Ç—å –≤–µ—â–∏"""

        return analysis, strategy

    def _get_money_general_answer(self, question, time_str):
        """–¢–û–õ–¨–ö–û –ø—Ä–æ –¥–µ–Ω—å–≥–∏ –≤–æ–æ–±—â–µ!"""
        analysis = f"""
*üí∞ –•–û–†–ê–†–ù–´–ô –§–ò–ù–ê–ù–°–û–í–´–ô –ê–ù–ê–õ–ò–ó*

*–í—Ä–µ–º—è:* {time_str}
*–í–æ–ø—Ä–æ—Å:* ¬´{question}¬ª

---

*üíé –¢–í–û–Ø –§–ò–ù–ê–ù–°–û–í–ê–Ø –°–ò–¢–£–ê–¶–ò–Ø:*

‚ú® *–¢–ï–ö–£–©–ò–ô –ü–û–¢–û–ö:*
–°—Ç–∞–±–∏–ª—å–Ω—ã–π, –Ω–æ –µ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è —Ä–æ—Å—Ç–∞

‚ú® *–ë–õ–ò–ñ–ê–ô–®–ò–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò:*
‚Ä¢ –ü–æ–≤—ã—à–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ 2-4 –Ω–µ–¥–µ–ª–∏
‚Ä¢ –ù–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∑–∞—Ä–∞–±–æ—Ç–∫–∞
‚Ä¢ –£–ª—É—á—à–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
"""
        
        strategy = """*üéØ –ß–¢–û –î–ï–õ–ê–¢–¨ –° –î–ï–ù–¨–ì–ê–ú–ò:*
‚Ä¢ –ò–Ω–≤–µ—Å—Ç–∏—Ä—É–π –≤ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
‚Ä¢ –°–æ–∑–¥–∞–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –ø–æ–¥—É—à–∫—É
‚Ä¢ –ò—â–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ—Ö–æ–¥—ã
‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π —Ä–∞—Å—Ö–æ–¥—ã"""

        return analysis, strategy

    def _get_career_answer(self, question, time_str):
        """–¢–û–õ–¨–ö–û –ø—Ä–æ –∫–∞—Ä—å–µ—Ä—É!"""
        analysis = f"""
*üíº –•–û–†–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó –ö–ê–†–¨–ï–†–´*

*–í—Ä–µ–º—è:* {time_str}
*–í–æ–ø—Ä–æ—Å:* ¬´{question}¬ª

---

*üöÄ –¢–í–û–ò –ö–ê–†–¨–ï–†–ù–´–ï –ü–ï–†–°–ü–ï–ö–¢–ò–í–´:*

‚ú® *–¢–ï–ö–£–©–ê–Ø –°–ò–¢–£–ê–¶–ò–Ø:*
–ü–µ—Ä–∏–æ–¥ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞

‚ú® *–í–û–ó–ú–û–ñ–ù–û–°–¢–ò:*
‚Ä¢ –ü–æ–≤—ã—à–µ–Ω–∏–µ –≤ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
‚Ä¢ –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
‚Ä¢ –ü—Ä–∏–∑–Ω–∞–Ω–∏–µ –∑–∞—Å–ª—É–≥
"""
        
        strategy = """*üéØ –ö–ê–†–¨–ï–†–ù–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø:*
‚Ä¢ –ü—Ä–æ—è–≤–ª—è–π –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É
‚Ä¢ –£—á–∏—Å—å –Ω–æ–≤–æ–º—É
‚Ä¢ –°–µ—Ç–µ–≤–æ–π —Å –∫–æ–ª–ª–µ–≥–∞–º–∏
‚Ä¢ –ì–æ—Ç–æ–≤—å—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º"""

        return analysis, strategy

    def _get_health_answer(self, question, time_str):
        """–¢–û–õ–¨–ö–û –ø—Ä–æ –∑–¥–æ—Ä–æ–≤—å–µ!"""
        analysis = f"""
*üåø –•–û–†–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó –ó–î–û–†–û–í–¨–Ø*

*–í—Ä–µ–º—è:* {time_str}
*–í–æ–ø—Ä–æ—Å:* ¬´{question}¬ª

---

*üíö –¢–í–û–ï –°–û–°–¢–û–Ø–ù–ò–ï –ó–î–û–†–û–í–¨–Ø:*

‚ú® *–≠–ù–ï–†–ì–ï–¢–ò–ö–ê:*
–°—Ç–∞–±–∏–ª—å–Ω–∞—è, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

‚ú® *–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:*
‚Ä¢ –ë–æ–ª—å—à–µ –æ—Ç–¥—ã—Ö–∞
‚Ä¢ –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ
‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
"""
        
        strategy = """*üéØ –î–õ–Ø –ó–î–û–†–û–í–¨–Ø:*
‚Ä¢ –°–ª—É—à–∞–π —Å–≤–æ–µ —Ç–µ–ª–æ
‚Ä¢ –û–±—Ä–∞—Ç–∏—Å—å –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É
‚Ä¢ –ü—Ä–∞–∫—Ç–∏–∫—É–π –º–µ–¥–∏—Ç–∞—Ü–∏—é
‚Ä¢ –°–æ–±–ª—é–¥–∞–π —Ä–µ–∂–∏–º"""

        return analysis, strategy

    def _get_general_answer(self, question, time_str):
        """–û–ë–©–ò–ô –æ—Ç–≤–µ—Ç"""
        analysis = f"""
*üåå –•–û–†–ê–†–ù–´–ô –ê–ù–ê–õ–ò–ó*

*–í—Ä–µ–º—è:* {time_str}
*–í–æ–ø—Ä–æ—Å:* ¬´{question}¬ª

---

*‚ú® –û–¢–í–ï–¢ –í–´–°–®–ò–• –°–§–ï–†:*

–¢—ã –Ω–∞—Ö–æ–¥–∏—à—å—Å—è –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø—É—Ç–∏. –ó–≤–µ–∑–¥—ã –±–ª–∞–≥–æ–≤–æ–ª—è—Ç —Ç–≤–æ–∏–º –Ω–∞—á–∏–Ω–∞–Ω–∏—è–º.

*–ë–ª–∏–∂–∞–π—à–∏–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ.*
"""
        
        strategy = """*üéØ –°–û–í–ï–¢ –ò–ú–ü–ï–†–ê–¢–û–†–ê:*
‚Ä¢ –î–æ–≤–µ—Ä—è–π –∏–Ω—Ç—É–∏—Ü–∏–∏
‚Ä¢ –ë—É–¥—å —Å–º–µ–ª–µ–µ –≤ —Ä–µ—à–µ–Ω–∏—è—Ö
‚Ä¢ –¶–µ–Ω–∏ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç"""

        return analysis, strategy

# –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä
emperor = SmartEmperor()

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
@bot.message_handler(commands=['start', 'help'])
def send_welcome(message):
    greeting = emperor.get_greeting()
    response = f"{greeting}\n\n*–ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å –æ:*\n‚Ä¢ üíñ –õ—é–±–≤–∏ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö\n‚Ä¢ üí∞ –§–∏–Ω–∞–Ω—Å–∞—Ö\n‚Ä¢ üíº –ö–∞—Ä—å–µ—Ä–µ\n‚Ä¢ üåø –ó–¥–æ—Ä–æ–≤—å–µ\n\n*–ü—Ä–∏–º–µ—Ä:* ¬´–ß—Ç–æ –º–µ–Ω—è –∂–¥–µ—Ç –≤ –ª—é–±–≤–∏ –¥–æ –∫–æ–Ω—Ü–∞ –Ω–æ—è–±—Ä—è?¬ª"
    bot.reply_to(message, response, parse_mode='Markdown')

@bot.message_handler(func=lambda message: True)
def handle_message(message):
    try:
        text = message.text.strip()
        
        # –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
        if text.lower() in ['–ø—Ä–∏–≤–µ—Ç', '–Ω–∞—á–∞—Ç—å', '–∏–º–ø–µ—Ä–∞—Ç–æ—Ä', '–±–æ—Ç']:
            greeting = emperor.get_greeting()
            response = f"{greeting}\n\n–ó–∞–¥–∞–π —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å, –∏ —è –¥–∞–º —Ç–æ—á–Ω—ã–π –æ—Ç–≤–µ—Ç!"
            bot.reply_to(message, response, parse_mode='Markdown')
            return
        
        # –ù–∞—Å—Ç–æ—è—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
        bot.send_chat_action(message.chat.id, 'typing')
        time.sleep(1)
        
        analysis, strategy = emperor.generate_answer(text)
        full_response = f"{analysis}\n\n*üéØ –ß–¢–û –î–ï–õ–ê–¢–¨:*\n{strategy}"
        
        bot.reply_to(message, full_response, parse_mode='Markdown')
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        bot.reply_to(message, "üîÆ *–ó–≤–µ–∑–¥—ã –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–∫—Ä—ã—Ç—ã... –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑*", parse_mode='Markdown')

print("üåå –£–ú–ù–´–ô –ò–ú–ü–ï–†–ê–¢–û–† –ó–ê–ü–£–©–ï–ù!")
print("ü§ñ –ë–æ—Ç –≥–æ—Ç–æ–≤ –¥–∞–≤–∞—Ç—å –¢–û–ß–ù–´–ï –æ—Ç–≤–µ—Ç—ã!")

# –ó–∞–ø—É—Å–∫
if __name__ == "__main__":
    try:
        bot.infinity_polling(timeout=60)
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        time.sleep(10)
